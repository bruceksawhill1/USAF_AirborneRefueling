(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    264274,       6231]
NotebookOptionsPosition[    258281,       6065]
NotebookOutlinePosition[    258786,       6084]
CellTagsIndexPosition[    258743,       6081]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", "  ", "\[IndentingNewLine]", "  ", 
  RowBox[{
  "Tanker", " ", "Refueling", " ", "Scheduler", " ", "with", " ", "Altitude", 
   " ", "Assignment", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
   RowBox[{"Author", ":", " ", 
    RowBox[{
     RowBox[{"Bruce", " ", "Sawhill"}], " ", "<", 
     RowBox[{
      RowBox[{"brucesawhill", "@", "gmail"}], ".", "com"}], ">"}]}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellFrame->{{0, 0}, {0, 2}},
 CellChangeTimes->{{3.6924586155192947`*^9, 3.6924586202227716`*^9}, {
  3.696789846052549*^9, 3.696789853624023*^9}, {3.696789914749743*^9, 
  3.6967899213983727`*^9}, {3.6967899608661013`*^9, 3.6967900429460707`*^9}, {
  3.696790150666732*^9, 3.696790215338951*^9}, {3.6967902865302753`*^9, 
  3.6967902925299597`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Function", " ", "Definitions"}], " ", "*)"}]], "Input",
 CellFrame->{{0, 0}, {0, 2}},
 CellChangeTimes->{{3.6924586155192947`*^9, 3.6924586202227716`*^9}, {
   3.696789846052549*^9, 3.696789853624023*^9}, {3.696789914749743*^9, 
   3.6967899213983727`*^9}, {3.6967899608661013`*^9, 3.6967900429460707`*^9}, 
   3.696790150666732*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Global", " ", "Constants"}], " ", "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6978516391801014`*^9, 3.697851648811734*^9}, {
  3.6978536473322554`*^9, 3.6978536490654297`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"paramfile", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "322500", ",", "200000", ",", "20000", ",", "120000", ",", "255", ",", 
      "10", ",", "180", ",", 
      RowBox[{"{", 
       RowBox[{"31", ",", "31", ",", "25", ",", "31", ",", "31"}], "}"}]}], 
     "}"}]}], ";", "\n", 
   RowBox[{"paramfile", ">>", "TankerSchedulerParameters"}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.698073845901917*^9, 3.6980738846496067`*^9}, {
  3.698073939372258*^9, 3.6980739480191607`*^9}, {3.698074014882058*^9, 
  3.698074038471179*^9}, {3.698074098571027*^9, 3.698074102342641*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"Import", "[", "\"\<TankerSchedulerParameters\>\"", "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6980738174417143`*^9, 3.6980738334113913`*^9}, {
  3.698073911305846*^9, 3.698073920496581*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MaxTankerWeight", "=", 
   RowBox[{"params", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxTankerFuel", "=", 
    RowBox[{"params", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Cannot", " ", "exceed", " ", "MaxTankerWeight"}], "-", 
    "TankerEmptyWeight"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MinReturnTankerFuel", "=", 
    RowBox[{"params", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Minimum", " ", "amount", " ", "of", " ", "fuel", " ", "onboard", " ", 
    "upon", " ", "return", " ", "to", " ", "base"}], " ", "*)"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TankerEmptyWeight", "=", 
   RowBox[{"params", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BaseTurnTime", " ", "=", 
    RowBox[{"params", "[", 
     RowBox[{"[", "5", "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "minutes", " ", "to", " ", "service", " ", "and", " ", "redeploy", " ", 
    "a", " ", "tanker", " ", "after", " ", "return", " ", "to", " ", "base"}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MinInterval", " ", "=", 
    RowBox[{"params", "[", 
     RowBox[{"[", "6", "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Minimum", " ", "interval", " ", "in", " ", "minutes", " ", "between", " ",
     "end", " ", "of", " ", "one", " ", "RF", " ", "event", " ", "and", " ", 
    "beginning", " ", "of", " ", "another", " ", "for", " ", "tanker", " ", 
    "serving", " ", "both"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MaxLoiter", "=", 
    RowBox[{"params", "[", 
     RowBox[{"[", "7", "]"}], "]"}]}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Maximum", " ", "minutes", " ", "to", " ", "allow", " ", "between", " ", 
    "RF", " ", "events", " ", "for", " ", "one", " ", "tanker"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"basecapacities", "=", 
    RowBox[{"params", "[", 
     RowBox[{"[", "8", "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Base", " ", "capacities"}], ",", " ", 
    RowBox[{
    "allowing", " ", "for", " ", "margin", " ", "of", " ", "maintenance", " ",
      "and", " ", "mechanicals"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"lowalts", "=", 
    RowBox[{"{", 
     RowBox[{
     "16000", ",", "17000", ",", "18000", ",", "15000", ",", "19000", ",", 
      "20000", ",", "21000"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Set", " ", "of", " ", "altitudes", " ", "assignable", " ", "to", " ", 
     "low", " ", "refueling", " ", "altiude", " ", "aircraft"}], ",", " ", 
    RowBox[{"in", " ", "order", " ", "of", " ", "preference"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"highalts", "=", 
    RowBox[{"{", 
     RowBox[{
     "25000", ",", "26000", ",", "27000", ",", "24000", ",", "28000", ",", 
      "23000", ",", "29000", ",", "30000", ",", "22000"}], "}"}]}], ";"}], 
  " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Set", " ", "of", " ", "altitudes", " ", "assignable", " ", "to", " ", 
     "high", " ", "refueling", " ", "altitude", " ", "aircraft"}], ",", " ", 
    RowBox[{"in", " ", "order", " ", "of", " ", "preference"}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.697851660047366*^9, 3.6978518604076138`*^9}, {
  3.6978518962412663`*^9, 3.697851905028719*^9}, {3.6978527513381467`*^9, 
  3.6978527784574275`*^9}, {3.697852928163142*^9, 3.697853004054807*^9}, {
  3.6978533641948357`*^9, 3.697853445709098*^9}, {3.697854058148328*^9, 
  3.6978541347305837`*^9}, {3.697854170089848*^9, 3.6978541747107487`*^9}, {
  3.697854662205516*^9, 3.6978547135720615`*^9}, {3.698073962767765*^9, 
  3.6980740096310635`*^9}, {3.698074057507433*^9, 3.6980740612403383`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"timeparse", "[", "timestring_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dayvalue", ",", "hourvalue", ",", "minutevalue", ",", "totalminutes"}], 
     "}"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"works", " ", "for", " ", "demand", " ", "format"}], " ", "*)"}],
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dayvalue", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"StringTake", "[", 
          RowBox[{"timestring", ",", "3"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"hourvalue", " ", "=", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"StringTake", "[", 
          RowBox[{"timestring", ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "6"}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"minutevalue", " ", "=", " ", 
        RowBox[{"ToExpression", "[", 
         RowBox[{"StringTake", "[", 
          RowBox[{"timestring", ",", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"totalminutes", " ", "=", " ", 
        RowBox[{
         RowBox[{"1440", " ", "dayvalue"}], " ", "+", " ", 
         RowBox[{"60", " ", "hourvalue"}], " ", "+", " ", "minutevalue"}]}]}],
       "\[IndentingNewLine]", "}"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6910772830905027`*^9, 3.691077305648727*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"reversetimeparse", "[", 
   RowBox[{"minfromzero_", ",", " ", "datestring_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "hour", ",", "minute", ",", "hourmilform", ",", "minutemilform", ",", 
      "hourstring", ",", "minutestring", ",", "output"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"hour", "=", 
       RowBox[{"Quotient", "[", 
        RowBox[{"minfromzero", ",", "60"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"minute", "=", 
       RowBox[{"Mod", "[", 
        RowBox[{"minfromzero", ",", "60"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hourmilform", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Quotient", "[", 
          RowBox[{"hour", ",", "10"}], "]"}], ",", 
         RowBox[{"Mod", "[", 
          RowBox[{"hour", ",", "10"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"minutemilform", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Quotient", "[", 
          RowBox[{"minute", ",", "10"}], "]"}], ",", 
         RowBox[{"Mod", "[", 
          RowBox[{"minute", ",", "10"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"hourstring", "=", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"hourmilform", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"hourmilform", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"minutestring", "=", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
         RowBox[{"ToString", "[", 
          RowBox[{"minutemilform", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ToString", "[", 
          RowBox[{"minutemilform", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"StringJoin", "[", 
        RowBox[{
        "datestring", ",", "\"\< \>\"", ",", "hourstring", ",", "\"\< \>\"", 
         ",", "minutestring"}], "]"}]}]}], "\[IndentingNewLine]", "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.684791629697095*^9, 3.6847916818672295`*^9}, {
  3.6847917771516304`*^9, 3.6847918033693066`*^9}, {3.6847919411636276`*^9, 
  3.6847920734268723`*^9}, {3.684792141721672*^9, 3.6847921530405464`*^9}, {
  3.6847926218666077`*^9, 3.6847927804173765`*^9}, {3.6847928907728662`*^9, 
  3.684792942092089*^9}, {3.69107841645324*^9, 3.691078434403172*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"daysadd", "[", 
    RowBox[{"timestring_", ",", "numdays_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dayvalue", ",", "newdayvalue", ",", "daystring", ",", "newstring"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "adds", " ", "days", " ", "to", " ", "time", " ", "given", " ", "in", 
       " ", "day", " ", "hour", " ", "min", " ", "format"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Does", " ", "not", " ", "change", " ", "month", " ", 
       RowBox[{"value", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dayvalue", "=", 
         RowBox[{"ToExpression", "[", 
          RowBox[{"StringTake", "[", 
           RowBox[{"timestring", ",", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newdayvalue", "=", 
         RowBox[{"dayvalue", "+", "numdays"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"daystring", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"\"\<0\>\"", ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"Quotient", "[", 
             RowBox[{"newdayvalue", ",", "10"}], "]"}], "]"}], ",", " ", 
           RowBox[{"ToString", "[", 
            RowBox[{"Mod", "[", 
             RowBox[{"newdayvalue", ",", "10"}], "]"}], "]"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"newstring", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"daystring", ",", " ", 
           RowBox[{"StringTake", "[", 
            RowBox[{"timestring", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.685038150371436*^9, 3.6850384678500605`*^9}, {
  3.6850385069768543`*^9, 3.685038507693243*^9}, {3.6850385475930405`*^9, 
  3.6850385737261133`*^9}, {3.6850386370992923`*^9, 3.6850386377618437`*^9}, {
  3.691078251689417*^9, 3.691078275223695*^9}, {3.691078336924028*^9, 
  3.691078337562417*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"theaterdemand", "[", "anchorparseddemand_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Format", ":", " ", 
     RowBox[{"{", 
      RowBox[{"anch", ",", " ", 
       RowBox[{"#", "_anch"}], ",", "t1", ",", "t2", ",", "alt", ",", "RFID", 
       ",", "N1", ",", "N2", ",", "ID3", ",", "ID4", ",", "Fuel", ",", 
       RowBox[{"#", "_theater"}]}], "}"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Sort", "[", 
    RowBox[{"(*", " ", 
     RowBox[{
     "time", " ", "is", " ", "000", " ", "hrs", " ", "at", " ", "beginning", 
      " ", "of", " ", "data", " ", "day"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"(*", " ", 
       RowBox[{
       "data", " ", "ordered", " ", "by", " ", "RF", " ", "start", " ", 
        "time", " ", 
        RowBox[{"(", "t1", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"anchno", ",", "i", ",", 
             RowBox[{
              RowBox[{"timeparse", "[", 
               RowBox[{"anchorparseddemand", "[", 
                RowBox[{"[", 
                 RowBox[{"anchno", ",", "i", ",", "2"}], "]"}], "]"}], "]"}], 
              "-", 
              RowBox[{"23", " ", "1440"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"timeparse", "[", 
               RowBox[{"anchorparseddemand", "[", 
                RowBox[{"[", 
                 RowBox[{"anchno", ",", "i", ",", "3"}], "]"}], "]"}], "]"}], 
              "-", 
              RowBox[{"23", " ", "1440"}]}], ",", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"anchorparseddemand", "[", 
                RowBox[{"[", 
                 RowBox[{"anchno", ",", "i"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "10"}], "}"}]}], "]"}]}], "}"}], ",", "1"}],
           "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"anchno", ",", " ", 
           RowBox[{"Length", "[", "anchorparseddemand", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"anchorparseddemand", "[", 
             RowBox[{"[", "anchno", "]"}], "]"}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "1"}], "\[IndentingNewLine]", 
      "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#2", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ">", 
       RowBox[{"#1", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.691180808084543*^9, 3.691180851715755*^9}, {
  3.691198307416657*^9, 3.69119831464222*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dayshift", "[", 
   RowBox[{"anchordemand_", ",", "numdays_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "demcopy", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"demcopy", " ", "=", " ", "anchordemand"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"demcopy", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "2"}], "]"}], "]"}], "=", 
            RowBox[{"daysadd", "[", 
             RowBox[{
              RowBox[{"demcopy", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}], ",", "numdays"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"demcopy", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "3"}], "]"}], "]"}], "=", 
            RowBox[{"daysadd", "[", 
             RowBox[{
              RowBox[{"demcopy", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "3"}], "]"}], "]"}], ",", "numdays"}], 
             "]"}]}]}], "\[IndentingNewLine]", "}"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", "demcopy", "]"}]}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "}"}], ";", "\[IndentingNewLine]", "demcopy"}]}],
    "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.691180465198572*^9, 3.6911806622299967`*^9}, {
  3.691197435090423*^9, 3.691197475207656*^9}, {3.69119761023298*^9, 
  3.691197610739349*^9}, {3.691197688154995*^9, 3.6911977171930323`*^9}, {
  3.6911977572569942`*^9, 3.6911977944902782`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"createanchorstring", "[", "anchno_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Create", " ", "anchor", " ", "identifier", " ", "string", " ", "of", " ", 
    "one", " ", "or", " ", "two", " ", "digits"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"\"\<ANCH\>\"", ",", " ", 
      RowBox[{"ToString", "[", 
       RowBox[{"Quotient", "[", 
        RowBox[{"anchno", ",", "10"}], "]"}], "]"}], ",", 
      RowBox[{"ToString", "[", 
       RowBox[{"Mod", "[", 
        RowBox[{"anchno", ",", "10"}], "]"}], "]"}]}], "]"}], 
    "\[IndentingNewLine]", "}"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6850386880460896`*^9, 3.6850387848175173`*^9}, {
  3.685038818700097*^9, 3.685038841421339*^9}, {3.6850395330142612`*^9, 
  3.68503954047372*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"parselatlong", "[", "llstring_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"For", " ", "demand", " ", "format"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ToExpression", "[", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"StringTake", "[", 
      RowBox[{"llstring", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"StringTake", "[", 
      RowBox[{"llstring", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"StringTake", "[", 
      RowBox[{"llstring", ",", " ", 
       RowBox[{"{", 
        RowBox[{"6", ",", "8"}], "}"}]}], "]"}], ",", 
     RowBox[{"StringTake", "[", 
      RowBox[{"llstring", ",", " ", 
       RowBox[{"{", 
        RowBox[{"9", ",", "10"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"convertplltodecimal", "[", "latlongvector_", "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"latlongvector", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"latlongvector", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "/", "60."}]}], ",", 
     RowBox[{
      RowBox[{"latlongvector", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"latlongvector", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "/", "60."}]}]}], "}"}]}], 
  "\n"}]], "Input"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"firstavailbyanchor", "[", 
    RowBox[{"anchorRFlist_", ",", "mininterval_", ",", "maxwait_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lRF", ",", "falist", ",", "timebetween", ",", "j"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Gives", " ", "next", " ", "RF", " ", "event", " ", "that", " ", "can",
         " ", "be", " ", "combined", " ", "with", " ", "indexed", " ", 
        "event"}], ",", "\[IndentingNewLine]", 
       RowBox[{"parsed", " ", "by", " ", "anchor"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lRF", "=", 
         RowBox[{"Length", "[", "anchorRFlist", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"falist", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "lRF", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"falist", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"i", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"j", "<", "lRF"}], " ", "&&", 
              RowBox[{
               RowBox[{
                RowBox[{"anchorRFlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "3"}], "]"}], "]"}], "-", 
                RowBox[{"anchorRFlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "4"}], "]"}], "]"}]}], "<", 
               "mininterval"}]}], " ", ",", " ", 
             RowBox[{"j", "+=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"falist", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"anchorRFlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "3"}], "]"}], "]"}], "-", 
                 RowBox[{"anchorRFlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ">", "maxwait"}], 
               " ", "||", 
               RowBox[{"j", ">", "lRF"}]}], ",", 
              RowBox[{"{", "}"}], ",", " ", "j"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"Length", "[", "anchorRFlist", "]"}], "-", "1"}]}], 
           "}"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "falist"}], "\[IndentingNewLine]", "}"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.691352649146204*^9, 3.6913526502990217`*^9}, {
  3.691444382191535*^9, 3.691444410675713*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"firstavailbytheater", "[", 
   RowBox[{"theaterRFlist_", ",", "mininterval_", ",", "maxwait_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lRF", ",", "falist", ",", "j"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Gives", " ", "next", " ", "RF", " ", "event", " ", "that", " ", "can", 
       " ", "be", " ", "combined", " ", "with", " ", "indexed", " ", 
       "event"}], ",", " ", 
      RowBox[{"testing", " ", "for", " ", "same", " ", "anchor"}]}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lRF", "=", 
        RowBox[{"Length", "[", "theaterRFlist", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"falist", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "lRF", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"falist", "[", 
         RowBox[{"[", 
          RowBox[{"-", "1"}], "]"}], "]"}], "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"i", "+", "1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "<", "lRF"}], " ", "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"theaterRFlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "3"}], "]"}], "]"}], "-", 
                 RowBox[{"theaterRFlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "4"}], "]"}], "]"}]}], "<", 
                "mininterval"}], " ", "||", " ", 
               RowBox[{
                RowBox[{"theaterRFlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}], "!=", 
                RowBox[{"theaterRFlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ",", 
            " ", 
            RowBox[{"j", "+=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"falist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"theaterRFlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "3"}], "]"}], "]"}], "-", 
                RowBox[{"theaterRFlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ">", "maxwait"}], 
              " ", "||", 
              RowBox[{"j", ">", "lRF"}]}], ",", 
             RowBox[{"{", "}"}], ",", " ", "j"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"Length", "[", "theaterRFlist", "]"}], "-", "1"}]}], 
          "}"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "falist"}], "\[IndentingNewLine]", "}"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.691443111726631*^9, 3.6914431309122868`*^9}, {
  3.6914431718468733`*^9, 3.691443199703104*^9}, {3.69144324708074*^9, 
  3.691443268864691*^9}, {3.691443353423613*^9, 3.691443354140501*^9}, {
  3.691443482949951*^9, 3.691443484291232*^9}, {3.6914437245073233`*^9, 
  3.6914437324676447`*^9}, {3.691443805542473*^9, 3.691443831452353*^9}, {
  3.691443902190415*^9, 3.691443950820731*^9}, {3.691444421057556*^9, 
  3.6914444506390343`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"firstavailbytheater2", "[", 
   RowBox[{"theaterRFlist_", ",", "mininterval_", ",", "maxwait_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lRF", ",", "falist", ",", "j"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Gives", " ", "next", " ", "RF", " ", "event", " ", "that", " ", "can", 
       " ", "be", " ", "combined", " ", "with", " ", "indexed", " ", 
       "event"}], ",", " ", 
      RowBox[{"testing", " ", "for", " ", "same", " ", "anchor"}]}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lRF", "=", 
        RowBox[{"Length", "[", "theaterRFlist", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"falist", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "lRF", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"falist", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "=", 
          RowBox[{"{", "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"i", "+", "1"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"j", "<=", "lRF"}], " ", "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"theaterRFlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "3"}], "]"}], "]"}], "-", 
                 RowBox[{"theaterRFlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "4"}], "]"}], "]"}]}], "<", 
                "mininterval"}], " ", "||", " ", 
               RowBox[{
                RowBox[{"theaterRFlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "1"}], "]"}], "]"}], "!=", 
                RowBox[{"theaterRFlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], ")"}]}], ",", 
            " ", 
            RowBox[{"j", "+=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"j", ">", "lRF"}], ",", " ", 
            RowBox[{
             RowBox[{"falist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{
             RowBox[{"falist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"theaterRFlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "3"}], "]"}], "]"}], "-", 
                 RowBox[{"theaterRFlist", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ">", "maxwait"}], 
               ",", 
               RowBox[{"{", "}"}], ",", " ", "j"}], "]"}]}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"Length", "[", "theaterRFlist", "]"}], "-", "1"}]}], 
          "}"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "falist"}], "\[IndentingNewLine]", "}"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.691443111726631*^9, 3.6914431309122868`*^9}, {
  3.6914431718468733`*^9, 3.691443199703104*^9}, {3.69144324708074*^9, 
  3.691443268864691*^9}, {3.691443353423613*^9, 3.691443354140501*^9}, {
  3.691443482949951*^9, 3.691443484291232*^9}, {3.6914437245073233`*^9, 
  3.6914437324676447`*^9}, {3.691443805542473*^9, 3.691443831452353*^9}, {
  3.691443902190415*^9, 3.691443950820731*^9}, {3.691444421057556*^9, 
  3.6914444506390343`*^9}, {3.691869411289633*^9, 3.69186942534945*^9}, {
  3.691869534203657*^9, 3.691869534306752*^9}, {3.691869588775968*^9, 
  3.691869616411541*^9}, {3.69186984314187*^9, 3.6918699494881907`*^9}, {
  3.691870023265416*^9, 3.69187002597423*^9}}],

Cell["\<\
Fuel burn model obtained from mining aropOffload();  Value does not include \
offloaded fuel, it is fuel burned by tanker during offload process.\
\>", "Text",
 CellChangeTimes->{{3.6875429895469847`*^9, 3.68754301879932*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fuelburnfn", "[", 
   RowBox[{"m_", ",", "t_", ",", "off_"}], "]"}], ":=", 
  RowBox[{"127.553", "-", 
   RowBox[{".00487364", " ", "off"}], "+", 
   RowBox[{"143.878", " ", "t"}], " ", "+", " ", 
   RowBox[{".0000994124", " ", "m", " ", "t"}], "+", 
   RowBox[{"8.2217", " ", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "10"}], ")"}]}], " ", 
    RowBox[{"m", "^", "2"}], " ", "t"}]}]}]], "Input",
 CellChangeTimes->{{3.687542598711656*^9, 3.6875426984052887`*^9}}],

Cell["Same with all input masses in klbs, output still in lbs.", "Text",
 CellChangeTimes->{{3.687803998468302*^9, 3.68780400244986*^9}, {
  3.6909270518143473`*^9, 3.6909270580824823`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fuelburnkfn", "[", 
   RowBox[{"m_", ",", "t_", ",", "off_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"127.553", "-", 
     RowBox[{"4.87364", " ", "off"}], "+", 
     RowBox[{"143.878", " ", "t"}], " ", "+", " ", 
     RowBox[{".0994124", " ", "m", " ", "t"}], "+", 
     RowBox[{"8.2217", " ", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "4"}], ")"}]}], " ", 
      RowBox[{"m", "^", "2"}], " ", "t"}]}], ")"}], "/", "1000."}]}]], "Input",
 CellChangeTimes->{{3.6878038897901077`*^9, 3.687803951924715*^9}, {
  3.687804856441012*^9, 3.6878048631112833`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rftimeintervals", "[", "refuellist_", "]"}], ":=", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "time", " ", "intervals", " ", "betwen", " ", "end", " ", "of", " ", 
       "one", "\[IndentingNewLine]", "refueling", " ", "event", " ", "and", 
       " ", "start", " ", "of", " ", 
       RowBox[{"another", ".", " ", "Only"}], " ", "really", " ", "useful", 
       " ", "for", " ", "anchor"}], "-", 
      RowBox[{"based", " ", "calculations"}]}], ",", " ", 
     RowBox[{
      RowBox[{"not", " ", "theater"}], "-", "wide"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"refuellist", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "3"}], "]"}], "]"}], "-", 
      RowBox[{"refuellist", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "4"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "refuellist", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "refuellist", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.691086591354867*^9, 3.691086594312994*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rftimeintervals2", "[", 
   RowBox[{"refuellist_", ",", "arg1_", ",", "arg2_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "diff", "}"}], ",", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Faster", " ", "version", " ", "of", " ", "first", " ", "function"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"diff", "=", 
        RowBox[{
         RowBox[{"refuellist", "[", 
          RowBox[{"[", 
           RowBox[{"arg2", ",", "3"}], "]"}], "]"}], "-", 
         RowBox[{"refuellist", "[", 
          RowBox[{"[", 
           RowBox[{"arg1", ",", "4"}], "]"}], "]"}]}]}], ";"}], 
      "\[IndentingNewLine]", "}"}], ";", "\[IndentingNewLine]", "diff"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6917898218084307`*^9, 3.691789838294672*^9}, {
  3.691789875034956*^9, 3.69178993533762*^9}, {3.691789985453394*^9, 
  3.6917900691396313`*^9}, {3.691866881792178*^9, 3.69186688844906*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mmaholdoffload", "[", 
   RowBox[{
   "timeholdbefore_", ",", "timeoffload_", ",", "initialweight_", ",", 
    "offloadamt_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"loiterburn", ",", "afterloiterweight", ",", "deltaoffload"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"loiterburn", "=", 
        RowBox[{"fuelburnfn", "[", 
         RowBox[{"initialweight", ",", "timeholdbefore", ",", "0"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"afterloiterweight", "=", 
        RowBox[{"initialweight", "-", "loiterburn"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaoffload", "=", 
        RowBox[{"fuelburnfn", "[", 
         RowBox[{"afterloiterweight", ",", "timeoffload", ",", "offloadamt"}],
          "]"}]}], ";"}], "\[IndentingNewLine]", "}"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"loiterburn", "+", "deltaoffload", "+", "offloadamt"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6915184621352243`*^9, 3.691518616209972*^9}, {
  3.691518653910281*^9, 3.691518742872932*^9}, {3.6915187853876753`*^9, 
  3.691518786985392*^9}, {3.6915188527758417`*^9, 3.691518859005591*^9}, {
  3.6915198171960697`*^9, 3.691519820106987*^9}, {3.6915198754471703`*^9, 
  3.691519877169455*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mmaholdoffloadk", "[", 
   RowBox[{
   "timeholdbefore_", ",", "timeoffload_", ",", "initialweight_", ",", 
    "offloadamt_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"loiterburn", ",", "afterloiterweight", ",", "deltaoffload"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"loiterburn", "=", 
        RowBox[{"fuelburnkfn", "[", 
         RowBox[{"initialweight", ",", "timeholdbefore", ",", "0"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"afterloiterweight", "=", 
        RowBox[{"initialweight", "-", "loiterburn"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"deltaoffload", "=", 
        RowBox[{"fuelburnkfn", "[", 
         RowBox[{"afterloiterweight", ",", "timeoffload", ",", "offloadamt"}],
          "]"}]}], ";"}], "\[IndentingNewLine]", "}"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"loiterburn", "+", "deltaoffload", "+", "offloadamt"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.691519925209199*^9, 3.691519945469922*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tailassign", "[", 
    RowBox[{"eventlist_", ",", "basecaps_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "baseindices", ",", "baseindex", ",", "nexttail", ",", "nbi", ",", 
       "tailnumarray", ",", "availtailnums", ",", "neweventlist", ",", 
       "pos"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"(*", " ", "Initialization", " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"baseindices", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"eventlist", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "eventlist", "]"}]}], "}"}]}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nbi", "=", 
         RowBox[{"Length", "[", "baseindices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tailnumarray", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "nbi", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"availtailnums", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"j", ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "basecaps", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"basecaps", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"neweventlist", "=", "eventlist"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Local", " ", "variables", " ", "for", " ", "each", " ", 
             "event"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"baseindex", "=", 
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"baseindices", ",", 
                RowBox[{"eventlist", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", "2"}], "]"}], "]"}]}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<baseindex = \>\"", ",", " ", "baseindex"}], "]"}],
               ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"nexttail", "=", 
             RowBox[{"availtailnums", "[", 
              RowBox[{"[", 
               RowBox[{"baseindex", ",", "1"}], "]"}], "]"}]}], ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{
             "first", " ", "available", " ", "tail", " ", "at", " ", "base"}],
              " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{"\"\<nexttail = \>\"", ",", " ", "nexttail"}], "]"}], 
              ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"If", " ", "a", " ", "mission", " ", "launches"}], ",",
                " ", 
               RowBox[{
               "pop", " ", "the", " ", "tail", " ", "number", " ", "stack", 
                " ", "for", " ", "assignment"}], ",", " ", 
               RowBox[{"recycled", " ", "ones", " ", "first"}]}], " ", "*)"}],
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"eventlist", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "5"}], "]"}], "]"}], "\[Equal]", 
               RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"tailnumarray", "[", 
                   RowBox[{"[", "baseindex", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"nexttail", ",", 
                    RowBox[{"eventlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "1"}], "]"}], "]"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"neweventlist", "[", 
                   RowBox[{"[", "k", "]"}], "]"}], ",", "nexttail"}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"pos", "=", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"neweventlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", 
                    RowBox[{"Length", "[", "neweventlist", "]"}]}], "}"}]}], 
                    "]"}], ",", 
                   RowBox[{"eventlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "1"}], "]"}], "]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"pos", "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"pos", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<positions = \>\"", ",", "pos"}], "]"}], ";"}],
                  "*)"}], "\[IndentingNewLine]", 
                RowBox[{"Do", "[", 
                 RowBox[{
                  RowBox[{"AppendTo", "[", 
                   RowBox[{
                    RowBox[{"neweventlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"pos", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
                    "nexttail"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "pos", "]"}]}], "}"}]}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"availtailnums", "[", 
                  RowBox[{"[", "baseindex", "]"}], "]"}], "=", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"availtailnums", "[", 
                    RowBox[{"[", "baseindex", "]"}], "]"}], ",", "nexttail"}],
                   "]"}]}], ";"}], "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<availtailnums[[\>\"", ",", "baseindex", ",", 
                  "\"\<]]= \>\"", ",", " ", 
                  RowBox[{"availtailnums", "[", 
                   RowBox[{"[", "baseindex", "]"}], "]"}]}], "]"}], "*)"}], 
               "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"If", " ", "an", " ", 
                RowBox[{"A", "/", "C"}], " ", "has", " ", "been", " ", "at", 
                " ", "base", " ", "long", " ", "enough", " ", "to", " ", 
                "turn"}], ",", " ", 
               RowBox[{"add", " ", "to", " ", "availables"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"eventlist", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "5"}], "]"}], "]"}], "==", "2"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"availtailnums", "[", 
                 RowBox[{"[", "baseindex", "]"}], "]"}], "=", 
                RowBox[{"Sort", "[", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{
                   RowBox[{"availtailnums", "[", 
                    RowBox[{"[", "baseindex", "]"}], "]"}], ",", 
                   RowBox[{"neweventlist", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "6"}], "]"}], "]"}]}], "]"}], "]"}]}], 
               "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{
                 RowBox[{"Print", "[", "\"\<Here\>\"", "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Print", "[", 
                  RowBox[{"\"\<availtailnums = \>\"", ",", "availtailnums"}], 
                  "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "}"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
           "}"}], "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Length", "[", "eventlist", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"tailnumarray", ",", " ", "neweventlist"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.687706662699922*^9, 3.687706675452215*^9}, {
   3.68770670553269*^9, 3.687706827918398*^9}, {3.687706960523138*^9, 
   3.687707006827516*^9}, {3.687707048995413*^9, 3.687707258471582*^9}, {
   3.68770729273595*^9, 3.6877073123604403`*^9}, 3.687707369937953*^9, {
   3.687707435529861*^9, 3.687707969136758*^9}, {3.687708011536528*^9, 
   3.687708075265243*^9}, {3.68770813870823*^9, 3.687708140026001*^9}, {
   3.687708238400337*^9, 3.687708271904667*^9}, {3.687708682278571*^9, 
   3.687708713298574*^9}, {3.687708813897171*^9, 3.687708821953339*^9}, {
   3.687708865331924*^9, 3.687708872281312*^9}, {3.6877090462759743`*^9, 
   3.687709047294142*^9}, {3.6877090933639593`*^9, 3.687709098637443*^9}, {
   3.687709193828782*^9, 3.687709231394413*^9}, {3.6877093275655003`*^9, 
   3.6877093490348597`*^9}, {3.687709458272642*^9, 3.687709468364629*^9}, {
   3.687709623304151*^9, 3.6877098873208303`*^9}, {3.687709918634461*^9, 
   3.687709939961011*^9}, 3.6877128540002127`*^9, {3.68771455168421*^9, 
   3.6877145648088923`*^9}, {3.687714647191081*^9, 3.687714675861375*^9}, {
   3.687714739246703*^9, 3.687714761870413*^9}, {3.6877147924948473`*^9, 
   3.6877148329765673`*^9}, {3.6877148972960033`*^9, 3.687714924350617*^9}, {
   3.687715225809741*^9, 3.687715235057191*^9}, {3.687715285116065*^9, 
   3.6877153578377037`*^9}, {3.687715713039772*^9, 3.687715716455803*^9}, {
   3.687715777126337*^9, 3.687715869514802*^9}, {3.687715923176331*^9, 
   3.687715930966208*^9}, {3.68771604402424*^9, 3.6877160681604023`*^9}, {
   3.687716099936062*^9, 3.687716112134788*^9}, {3.687716191250794*^9, 
   3.6877162721226883`*^9}, {3.687716620307716*^9, 3.68771662474889*^9}, {
   3.68771668643152*^9, 3.68771671220846*^9}, {3.6877170866716137`*^9, 
   3.687717134725092*^9}, {3.687717442512912*^9, 3.687717459236658*^9}, {
   3.68771768341536*^9, 3.687717706670182*^9}, {3.687717752211131*^9, 
   3.687717754654991*^9}, {3.687717795993743*^9, 3.6877178080842876`*^9}, {
   3.688136932464662*^9, 3.688136932698861*^9}, {3.688137547268076*^9, 
   3.688137552727248*^9}, {3.688137586466197*^9, 3.688137595986928*^9}, {
   3.688137729802093*^9, 3.688137734434751*^9}, {3.690124188225655*^9, 
   3.690124196575927*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fastbase", "[", 
    RowBox[{"eventlist_", ",", "cutofftime_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"eventshortform", ",", "netdeploys", ",", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eventshortform", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"eventlist", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "4", ",", "5"}], "}"}]}], "]"}], "]"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", "eventlist", "]"}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ">", 
             RowBox[{"#1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"netdeploys", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "5"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{"(*", " ", 
          RowBox[{"Base", " ", "accounting"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"eventshortform", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "<", "cutofftime"}], " ",
            "&&", " ", 
           RowBox[{"i", "\[LessEqual]", " ", 
            RowBox[{"Length", "[", "eventlist", "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eventshortform", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}], "\[Equal]", 
               RowBox[{"-", "1"}]}], ",", " ", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"netdeploys", "[", 
                RowBox[{"[", 
                 RowBox[{"eventshortform", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "+=", 
               "1"}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"eventshortform", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}], "\[Equal]", "2"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"netdeploys", "[", 
                RowBox[{"[", 
                 RowBox[{"eventshortform", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "+=", 
               RowBox[{"-", "1"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[Equal]", 
               RowBox[{"Length", "[", "eventlist", "]"}]}], ",", 
              RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"i", "+=", "1"}]}], "\[IndentingNewLine]", "}"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ";", 
      "\[IndentingNewLine]", "netdeploys"}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.692289727341874*^9, 3.69228976739328*^9}, {
   3.692289802208625*^9, 3.692289806377111*^9}, {3.692289848735745*^9, 
   3.692289978228477*^9}, {3.692290011395042*^9, 3.692290112885119*^9}, {
   3.692290468009688*^9, 3.692290655583231*^9}, {3.692290831826498*^9, 
   3.692290852928615*^9}, {3.69229090969584*^9, 3.692290916613319*^9}, {
   3.6922910381835537`*^9, 3.692291056716919*^9}, {3.6922910883201437`*^9, 
   3.692291088531962*^9}, {3.6922912109543133`*^9, 3.692291228118929*^9}, {
   3.692291258793872*^9, 3.692291354163518*^9}, {3.692291432167446*^9, 
   3.6922914439815474`*^9}, {3.692291509152614*^9, 3.692291532957294*^9}, {
   3.692291601815136*^9, 3.692291607748506*^9}, {3.6922916728997793`*^9, 
   3.692291681513936*^9}, {3.692291720197266*^9, 3.692291784661981*^9}, {
   3.692291964176545*^9, 3.692292017047284*^9}, {3.692292083587377*^9, 
   3.6922921140175467`*^9}, {3.692292181948531*^9, 3.692292212537313*^9}, {
   3.692292244387891*^9, 3.692292268724696*^9}, {3.692292323092401*^9, 
   3.692292448891869*^9}, 3.692292479005074*^9, {3.692292523797522*^9, 
   3.6922925686621103`*^9}, {3.692292632003128*^9, 3.69229266211239*^9}, {
   3.692292692522616*^9, 3.692292696294799*^9}, {3.692292794110561*^9, 
   3.6922928057565327`*^9}, {3.692292974399693*^9, 3.692293053947056*^9}, {
   3.692293190631255*^9, 3.692293229023396*^9}, {3.692293301138899*^9, 
   3.692293302639822*^9}, {3.6922935446871147`*^9, 3.692293557596511*^9}, {
   3.692293631702635*^9, 3.69229367279657*^9}, {3.692293763014145*^9, 
   3.6922937733858023`*^9}, {3.692293867944107*^9, 3.692293925765588*^9}, 
   3.6922941957934303`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dynamicbaseassign", "[", 
   RowBox[{"deploys_", ",", "basecaps_", ",", "basepreforder_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "assignedbase", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"deploys", "[", 
           RowBox[{"[", 
            RowBox[{"basepreforder", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "\[GreaterEqual]", 
          RowBox[{"basecaps", "[", 
           RowBox[{"[", 
            RowBox[{"basepreforder", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"i", "++"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"assignedbase", "=", 
        RowBox[{"basepreforder", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], 
     ";", "\[IndentingNewLine]", "assignedbase"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.692312886577697*^9, 3.6923129277050533`*^9}, {
  3.692312958774852*^9, 3.6923130152077417`*^9}, {3.6923130557268467`*^9, 
  3.692313170998908*^9}, {3.692313218070487*^9, 3.69231325844407*^9}, {
  3.692313314910033*^9, 3.692313316998271*^9}, {3.692313372043688*^9, 
  3.6923133996465816`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"totaltails", "[", "tailassignlist_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "maxvector", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"maxvector", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", "5", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"maxvector", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"Max", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"tailassignlist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"tailassignlist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "5"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "}"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plus", "@@", "maxvector"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.692459441965486*^9, 3.6924594658597307`*^9}, {
  3.692459509853249*^9, 3.692459743411746*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Data", " ", "Preprocessing"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.692458649962639*^9, 3.6924586541335583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"elapsedtimeformat", "[", "totalminutes_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m", ",", "h", ",", "hs", ",", "ms"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"h", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"totalminutes", "<", "1440"}], ",", " ", 
           RowBox[{"Quotient", "[", 
            RowBox[{"totalminutes", ",", "60"}], "]"}], ",", 
           RowBox[{"Quotient", "[", 
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"totalminutes", ",", "1440"}], "]"}], ",", "60"}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"h", "=", 
         RowBox[{"Floor", "[", "h", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hs", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"h", "<", "10"}], ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "0", "]"}], ",", 
             RowBox[{"ToString", "[", "h", "]"}]}], "]"}], ",", 
           RowBox[{"ToString", "[", "h", "]"}]}], "]"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{"totalminutes", ",", "60"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"Floor", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ms", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"m", "<", "10"}], ",", " ", 
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"ToString", "[", "0", "]"}], ",", 
             RowBox[{"ToString", "[", "m", "]"}]}], "]"}], ",", 
           RowBox[{"ToString", "[", "m", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"hs", ",", "\"\<:\>\"", ",", "ms"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "}"}], ";", "\[IndentingNewLine]", "result"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6876247008966846`*^9, 3.68762486293911*^9}, 
   3.6876248933432417`*^9, {3.687624975496916*^9, 3.6876249758529654`*^9}, {
   3.687625011237322*^9, 3.687625080399481*^9}, {3.687625127155545*^9, 
   3.687625306738998*^9}, {3.687625495687991*^9, 3.6876255785844307`*^9}, {
   3.687626546749523*^9, 3.6876265648219852`*^9}, {3.687626595016774*^9, 
   3.687626619248472*^9}, {3.6876266734192*^9, 3.687626675926504*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"miltimeformat", "[", 
    RowBox[{"startmonth_", ",", "startday_", ",", "minutes_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "monthdays", ",", "minutesinmonth", ",", "daynum", ",", "minnum", ",", 
       "hournum", ",", "remainminutes", ",", "hourstring", ",", 
       "minutestring"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"monthdays", "=", 
         RowBox[{"Switch", "[", "\[IndentingNewLine]", 
          RowBox[{"startmonth", ",", "1", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<JAN\>\"", ",", "31"}], "}"}], ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<FEB\>\"", ",", "28"}], "}"}], ",", "3", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<MAR\>\"", ",", "31"}], "}"}], ",", 
           "\[IndentingNewLine]", "4", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<APR\>\"", ",", "30"}], "}"}], ",", "5", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<MAY\>\"", ",", "31"}], "}"}], ",", "6", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<JUN\>\"", ",", "30"}], "}"}], ",", 
           "\[IndentingNewLine]", "7", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<JUL\>\"", ",", "31"}], "}"}], ",", "8", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<AUG\>\"", ",", "31"}], "}"}], ",", "9", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<SEP\>\"", ",", "31"}], "}"}], ",", 
           "\[IndentingNewLine]", "10", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<OCT\>\"", ",", "31"}], "}"}], ",", "11", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<NOV\>\"", ",", "31"}], "}"}], ",", "12", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<DEC\>\"", ",", "31"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minutesinmonth", "=", 
         RowBox[{
          RowBox[{"startday", "  ", "1440"}], "+", "minutes"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"daynum", "=", 
         RowBox[{"Quotient", "[", 
          RowBox[{"minutesinmonth", ",", "1440"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minnum", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{"minutesinmonth", ",", "1440"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hournum", "=", 
         RowBox[{"Quotient", "[", 
          RowBox[{"minnum", ",", "60"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"hourstring", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"hournum", "<", "10"}], ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<0\>\"", ",", 
             RowBox[{"ToString", "[", "hournum", "]"}]}], "]"}], ",", 
           RowBox[{"ToString", "[", "hournum", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"minnum", "=", 
         RowBox[{"Mod", "[", 
          RowBox[{"minnum", ",", "60"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"minutestring", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"minnum", "<", "10"}], ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<0\>\"", ",", 
             RowBox[{"ToString", "[", "minnum", "]"}]}], "]"}], ",", 
           RowBox[{"ToString", "[", "minnum", "]"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", "}"}], ";", "\[IndentingNewLine]", 
      RowBox[{"StringJoin", "[", 
       RowBox[{
        RowBox[{"monthdays", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< \>\"", ",", " ", 
        RowBox[{"ToString", "[", "daynum", "]"}], ",", " ", "\"\< \>\"", ",", 
        "hourstring", ",", "\"\<:\>\"", ",", "minutestring"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.690125389933147*^9, 3.690125495247239*^9}, {
  3.69012554562601*^9, 3.690125809077531*^9}, {3.690125880608136*^9, 
  3.690125912468145*^9}, {3.690125942620967*^9, 3.690125953142046*^9}, {
  3.690126023833844*^9, 3.6901260798043623`*^9}, {3.690126198795021*^9, 
  3.690126255979645*^9}, {3.690126297594556*^9, 3.6901263742552767`*^9}, {
  3.69012642213218*^9, 3.690126674711524*^9}, {3.6901267483012123`*^9, 
  3.690126752671729*^9}, {3.6901412207203083`*^9, 3.690141325831026*^9}, {
  3.6901414199067993`*^9, 3.6901415456206636`*^9}, {3.690141576310096*^9, 
  3.6901415965593433`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fuelbasetoanchor", "[", 
   RowBox[{"anchorbasepair_", ",", "anchoralt_"}], "]"}], ":=", 
  RowBox[{"aabtf", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"anchoralt", ">", "14000"}], ",", 
       RowBox[{
        RowBox[{"anchoralt", "/", "1000"}], "-", "14"}], ",", "1"}], "]"}], 
     ",", 
     RowBox[{"anchorbasepair", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"anchorbasepair", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6822622290084405`*^9, 3.682262242916174*^9}, {
  3.68226227568713*^9, 3.6822623387094803`*^9}, {3.6822625286362123`*^9, 
  3.6822626582440295`*^9}, {3.6822627056865563`*^9, 3.68226270617107*^9}, {
  3.682263029846514*^9, 3.682263034425172*^9}, {3.692569384254182*^9, 
  3.692569389314992*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"timebasetoanchor", "[", 
   RowBox[{"anchorbasepair_", ",", "anchoralt_"}], "]"}], ":=", 
  RowBox[{"aabtf", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"anchoralt", ">", "14000"}], ",", 
       RowBox[{
        RowBox[{"anchoralt", "/", "1000"}], "-", "14"}], ",", "1"}], "]"}], 
     ",", 
     RowBox[{"anchorbasepair", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"anchorbasepair", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.682263370266344*^9, 3.682263373876012*^9}, {
  3.692569400068366*^9, 3.6925694038034554`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"assembletheatersorties", "[", 
   RowBox[{"tankerRFs_", ",", " ", "theaterdemand_", ",", "altitudes_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lRF", ",", "rfevents", ",", "startrf", ",", "endrf"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lRF", "=", 
        RowBox[{"Length", "[", "tankerRFs", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"rfevent", " ", 
         RowBox[{"format", ":", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"base", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"outbound", "/", "inbound"}], " ", "legs"}], ")"}], 
             " ", "or", " ", "anchor"}], ",", "\[IndentingNewLine]", 
            "startrf", ",", "endrf", ",", "altitude", ",", "offloadfuel", ",",
             "startfuel", ",", "endfuel"}]}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"rfevents", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "16"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "lRF"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"tankerRFs", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "+", "2"}]}], 
           "}"}]}], "]"}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{"16", " ", "column", " ", "table"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<numsorties = \>\"", ",", "lRF"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"startrf", "=", 
            RowBox[{"theaterdemand", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"tankerRFs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2", ",", "1"}], "]"}], "]"}], ",", "3"}], 
              "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"endrf", "=", 
            RowBox[{"theaterdemand", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"tankerRFs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2", ",", 
                  RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "4"}], "]"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rfevents", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], "=", 
            RowBox[{"baselocs", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"tankerRFs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3", ",", "1"}], "]"}], "]"}], ",", "3"}], 
              "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rfevents", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}], "=", 
            "\"\<\>\""}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rfevents", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1", ",", "3"}], "]"}], "]"}], "=", 
            "\"\<\>\""}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rfevents", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], "=", 
            RowBox[{"baselocs", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"tankerRFs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3", ",", "1"}], "]"}], "]"}], ",", "3"}], 
              "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rfevents", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}], "=", 
            "\"\<\>\""}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rfevents", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"-", "1"}], ",", "3"}], "]"}], "]"}], "=", 
            "\"\<\>\""}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"rfevents", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", 
                   RowBox[{"j", "+", "1"}]}], "]"}], "]"}], "=", 
                RowBox[{"{", 
                 RowBox[{"\"\<\>\"", ",", "\"\<\>\"", " ", ",", 
                  RowBox[{"anchorlist", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankerRFs", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3", ",", "2"}], "]"}], "]"}], ",", 
                    "1"}], "]"}], "]"}], ",", 
                  RowBox[{"theaterdemand", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankerRFs", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2", ",", "j"}], "]"}], "]"}], ",", 
                    "3"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"theaterdemand", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankerRFs", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2", ",", "j"}], "]"}], "]"}], ",", 
                    "4"}], "]"}], "]"}], ",", 
                  RowBox[{"altitudes", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"theaterdemand", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankerRFs", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2", ",", "j"}], "]"}], "]"}], ",", 
                    "11"}], "]"}], "]"}], ",", "0", ",", "0", ",", "0", ",", 
                  "0", ",", "0", ",", "\[IndentingNewLine]", 
                  RowBox[{"theaterdemand", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankerRFs", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2", ",", "j"}], "]"}], "]"}], ",", 
                    "6"}], "]"}], "]"}], "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{"pd", "[", 
                    RowBox[{"[", 
                    RowBox[{"anchorindex", ",", 
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", "anchorindex", "]"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1", ",", "i", ",", "j"}], "]"}], "]"}],
                     ",", "5"}], "]"}], "]"}], "*)"}], ",", 
                  RowBox[{"theaterdemand", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankerRFs", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2", ",", "j"}], "]"}], "]"}], ",", 
                    "8"}], "]"}], "]"}], ",", 
                  RowBox[{"theaterdemand", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankerRFs", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2", ",", "j"}], "]"}], "]"}], ",", 
                    "10"}], "]"}], "]"}], ",", 
                  RowBox[{"theaterdemand", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankerRFs", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2", ",", "j"}], "]"}], "]"}], ",", 
                    "9"}], "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
               ";"}], "\[IndentingNewLine]", "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"tankerRFs", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rfevents", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2", ",", "9"}], "]"}], "]"}], "=", 
            RowBox[{"MaxTankerFuel", "-", 
             RowBox[{"fuelbasetoanchor", "[", 
              RowBox[{
               RowBox[{"tankerRFs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
               RowBox[{"altitudes", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rfevents", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1", ",", "4"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"rfevents", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2", ",", "4"}], "]"}], "]"}], "-", 
             RowBox[{"timebasetoanchor", "[", 
              RowBox[{
               RowBox[{"tankerRFs", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
               RowBox[{"altitudes", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "-", "10"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rfevents", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1", ",", "5"}], "]"}], "]"}], "=", 
            RowBox[{
             RowBox[{"rfevents", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2", ",", "4"}], "]"}], "]"}], "-", "10"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rfevents", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1", ",", "9"}], "]"}], "]"}], "=", 
            "MaxTankerFuel"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rfevents", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1", ",", "10"}], "]"}], "]"}], "=", 
            RowBox[{"rfevents", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2", ",", "9"}], "]"}], "]"}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "lRF"}], "}"}]}], "\[IndentingNewLine]",
         "]"}], ";"}], "\[IndentingNewLine]", "}"}], ";", 
     "\[IndentingNewLine]", "rfevents"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6822558681687107`*^9, 3.682255892640153*^9}, {
   3.6822560069023876`*^9, 3.6822560132000303`*^9}, {3.6822560975216227`*^9, 
   3.6822561851873264`*^9}, {3.682256254054037*^9, 3.6822562850418453`*^9}, {
   3.682256342969967*^9, 3.682256417087248*^9}, {3.6822565801674232`*^9, 
   3.6822566404239197`*^9}, 3.682256670645872*^9, 3.6822567165571237`*^9, {
   3.6822568065355835`*^9, 3.6822568537437124`*^9}, {3.6822569927274494`*^9, 
   3.6822570722517376`*^9}, {3.6822571178503184`*^9, 
   3.6822571413997746`*^9}, {3.682257206016076*^9, 3.682257206297361*^9}, {
   3.6822572833213367`*^9, 3.6822573155904803`*^9}, {3.682257368252409*^9, 
   3.6822574238990374`*^9}, {3.6822575384113836`*^9, 3.682257583400611*^9}, {
   3.6822578655246973`*^9, 3.6822578668842196`*^9}, {3.682257936173031*^9, 
   3.682258079735347*^9}, {3.682258140210571*^9, 3.6822581420077257`*^9}, {
   3.6822581745893526`*^9, 3.6822581822464314`*^9}, {3.6822582186878734`*^9, 
   3.682258260567305*^9}, {3.6822584559947124`*^9, 3.6822584946082497`*^9}, 
   3.6822585500985546`*^9, {3.682258611823933*^9, 3.682258700395979*^9}, {
   3.6822587321025257`*^9, 3.6822587328058124`*^9}, {3.6822592226554513`*^9, 
   3.6822592333909864`*^9}, {3.6822592808648353`*^9, 3.682259289600145*^9}, {
   3.6822593371208906`*^9, 3.682259403924971*^9}, {3.682259502279402*^9, 
   3.6822595628639927`*^9}, {3.6822595968430767`*^9, 3.682259596921179*^9}, 
   3.682259729243495*^9, {3.6822597714199476`*^9, 3.682259780874064*^9}, {
   3.682261635975787*^9, 3.6822616927943277`*^9}, {3.6822618212613707`*^9, 
   3.682261833262686*^9}, {3.6822628697823753`*^9, 3.682262941977745*^9}, {
   3.6822630801019816`*^9, 3.6822630875714903`*^9}, {3.682263331590231*^9, 
   3.6822633547958317`*^9}, {3.68226341722449*^9, 3.6822634325854797`*^9}, {
   3.6822634660734673`*^9, 3.682263466245349*^9}, {3.682263508921916*^9, 
   3.6822635091406126`*^9}, {3.6822635676312857`*^9, 
   3.6822636086513343`*^9}, {3.6822636633448124`*^9, 
   3.6822637141002064`*^9}, {3.6822682474484997`*^9, 
   3.6822682767485423`*^9}, {3.682268323722384*^9, 3.6822683537568483`*^9}, {
   3.6822683923547583`*^9, 3.6822683925109854`*^9}, {3.6822684723477087`*^9, 
   3.6822684760043535`*^9}, {3.682269004323464*^9, 3.682269026435223*^9}, {
   3.6822693733006697`*^9, 3.682269376316617*^9}, {3.6823522386550274`*^9, 
   3.682352257485183*^9}, {3.682356549324376*^9, 3.682356551087777*^9}, {
   3.682357058554596*^9, 3.682357059350128*^9}, {3.682388901435763*^9, 
   3.6823889054830575`*^9}, {3.682388935642617*^9, 3.6823889568011484`*^9}, {
   3.6823890296839337`*^9, 3.682389042544769*^9}, {3.6823892681315756`*^9, 
   3.6823892859771986`*^9}, {3.6823893971141853`*^9, 
   3.6823894087561307`*^9}, {3.6823894956717396`*^9, 3.6823894999690275`*^9}, 
   3.6847641425242615`*^9, {3.6847644225994663`*^9, 3.6847644310581465`*^9}, {
   3.6847646937249165`*^9, 3.6847646986909957`*^9}, {3.684764840373847*^9, 
   3.6847648452298403`*^9}, {3.6847649683109055`*^9, 
   3.6847649690493183`*^9}, {3.6847650339714355`*^9, 
   3.6847650406450043`*^9}, {3.684765481997485*^9, 3.684765482466407*^9}, {
   3.684765523236087*^9, 3.684765556937766*^9}, {3.6847661247451425`*^9, 
   3.6847661774296503`*^9}, {3.684766765165636*^9, 3.6847667706704917`*^9}, {
   3.6847671300867767`*^9, 3.6847671359539022`*^9}, {3.6847672205521555`*^9, 
   3.6847672264582157`*^9}, {3.6847676057385635`*^9, 
   3.6847676281022015`*^9}, {3.6847676922713146`*^9, 
   3.6847677077056828`*^9}, {3.684767821739673*^9, 3.6847678279905596`*^9}, {
   3.684768056764703*^9, 3.6847681163690453`*^9}, {3.6847684118136115`*^9, 
   3.6847684199737315`*^9}, {3.684768540550657*^9, 3.6847685410876083`*^9}, {
   3.6847690547624564`*^9, 3.684769104209275*^9}, {3.684770328816327*^9, 
   3.6847703540180016`*^9}, {3.684770402206623*^9, 3.6847704186816034`*^9}, {
   3.6847707563084993`*^9, 3.684770774676937*^9}, {3.684770861398831*^9, 
   3.684770864439207*^9}, {3.684771311509981*^9, 3.684771327336814*^9}, {
   3.6847714895801125`*^9, 3.684771492651662*^9}, {3.6847904865183067`*^9, 
   3.6847905150596704`*^9}, 3.6847905943298435`*^9, {3.6847908818890133`*^9, 
   3.68479088652561*^9}, {3.6847909978018684`*^9, 3.684791005548691*^9}, {
   3.6847912505109468`*^9, 3.6847913052177877`*^9}, {3.684791383662955*^9, 
   3.684791385048874*^9}, {3.6847931438412066`*^9, 3.684793163493574*^9}, {
   3.684793215574579*^9, 3.6847932432548428`*^9}, {3.6886639179345813`*^9, 
   3.688663926443904*^9}, {3.6886639861252837`*^9, 3.688663994681159*^9}, {
   3.688664026251005*^9, 3.6886640313870125`*^9}, {3.68866426823182*^9, 
   3.6886642700693493`*^9}, {3.6925654743472767`*^9, 3.692565500113051*^9}, {
   3.692565544051849*^9, 3.692565653762844*^9}, {3.692565719485196*^9, 
   3.692565720548689*^9}, {3.692565763109384*^9, 3.692565776757244*^9}, {
   3.692565829812009*^9, 3.6925659143517*^9}, {3.6925659567455*^9, 
   3.692565957595435*^9}, {3.692566042538539*^9, 3.692566168295199*^9}, {
   3.692566467934461*^9, 3.692566491936866*^9}, {3.6925665256439743`*^9, 
   3.6925665431151657`*^9}, {3.692566586194398*^9, 3.692566590462166*^9}, {
   3.692566901208312*^9, 3.69256692479576*^9}, {3.692567320329707*^9, 
   3.692567322295789*^9}, {3.692567459150207*^9, 3.692567460605047*^9}, {
   3.692567496581806*^9, 3.692567525629209*^9}, {3.692567636846159*^9, 
   3.692567700371131*^9}, {3.692567806184022*^9, 3.692567819734044*^9}, {
   3.692567859938898*^9, 3.692567863280225*^9}, {3.692567907241363*^9, 
   3.692567907485519*^9}, {3.6925679715269537`*^9, 3.692567971984902*^9}, {
   3.6925681183658*^9, 3.692568149532599*^9}, {3.6925684290147343`*^9, 
   3.6925684574054537`*^9}, {3.692568728239911*^9, 3.692568736857666*^9}, {
   3.692569171606063*^9, 3.69256917233121*^9}, {3.6925692381625547`*^9, 
   3.6925693261334143`*^9}, 3.692570063233111*^9, {3.6978524610101604`*^9, 
   3.6978524861173544`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sortiefuelburn", "[", 
   RowBox[{"tankerRFs_", ",", "sortiesmma_", ",", "index_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "modsortie", ",", "startanchor", ",", "endanchor", ",", "initfuel", ",", 
      "basecoords", ",", "afterloiter", ",", "lb", ",", "rfdelta", ",", 
      "rfdu", ",", "hometime", ",", "homeburn"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"modsortie", "=", 
        RowBox[{"sortiesmma", "[", 
         RowBox[{"[", "index", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"startanchor", "=", 
        RowBox[{"startlatlongs", "[", 
         RowBox[{"[", 
          RowBox[{"tankerRFs", "[", 
           RowBox[{"[", 
            RowBox[{"index", ",", "3", ",", "2"}], "]"}], "]"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"endanchor", "=", 
        RowBox[{"endlatlongs", "[", 
         RowBox[{"[", 
          RowBox[{"tankerRFs", "[", 
           RowBox[{"[", 
            RowBox[{"index", ",", "3", ",", "2"}], "]"}], "]"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"initfuel", "=", 
        RowBox[{"sortiesmma", "[", 
         RowBox[{"[", 
          RowBox[{"index", ",", "1", ",", "10"}], "]"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Fuel", " ", "on", " ", "board", " ", "at", " ", "anchor", " ", 
         "arrival"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"basecoords", "=", 
        RowBox[{"baselocs", "[", 
         RowBox[{"[", 
          RowBox[{"tankerRFs", "[", 
           RowBox[{"[", 
            RowBox[{"index", ",", "3", ",", "1"}], "]"}], "]"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{"(*", " ", 
         RowBox[{
         "the", " ", "rolling", " ", "fuel", " ", "burn", " ", "loop"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"modsortie", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "9"}], "]"}], "]"}], "=", "initfuel"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"aropOffload", "[", 
            RowBox[{"4", ",", "TankerEmptyWeight", ",", 
             RowBox[{"Floor", "[", 
              RowBox[{"modsortie", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "9"}], "]"}], "]"}], "]"}], ",", 
             "MaxTankerWeight", ",", "0", ",", " ", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"sortiesmma", "[", 
                RowBox[{"[", 
                 RowBox[{"index", ",", "j", ",", "6"}], "]"}], "]"}], "/", 
               "100"}], "]"}], ",", "270", ",", "0.8", ",", "0", ",", 
             RowBox[{"sa", "=", 
              RowBox[{
               RowBox[{"sortiesmma", "[", 
                RowBox[{"[", 
                 RowBox[{"index", ",", "j", ",", "4"}], "]"}], "]"}], "-", 
               RowBox[{"sortiesmma", "[", 
                RowBox[{"[", 
                 RowBox[{"index", ",", 
                  RowBox[{"j", "-", "1"}], ",", "5"}], "]"}], "]"}]}]}], ",", 
             RowBox[{"startanchor", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"startanchor", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"endanchor", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"endanchor", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "iptime", ",", "ipburn", 
             ",", "ipHoldff"}], "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"modsortie", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "11"}], "]"}], "]"}], "=", "ipburn"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"afterloiter", "=", 
            RowBox[{
             RowBox[{"modsortie", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "9"}], "]"}], "]"}], "-", "ipburn"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"lb", "=", "ipburn"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"aropOffload", "[", 
            RowBox[{"4", ",", "TankerEmptyWeight", ",", 
             RowBox[{"Floor", "[", "afterloiter", "]"}], ",", 
             "MaxTankerWeight", ",", "0", ",", " ", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"sortiesmma", "[", 
                RowBox[{"[", 
                 RowBox[{"index", ",", "j", ",", "6"}], "]"}], "]"}], "/", 
               "100"}], "]"}], ",", "270", ",", "0.8", ",", 
             RowBox[{"Floor", "[", 
              RowBox[{"sortiesmma", "[", 
               RowBox[{"[", 
                RowBox[{"index", ",", "j", ",", "7"}], "]"}], "]"}], "]"}], 
             ",", 
             RowBox[{"rfdu", "=", 
              RowBox[{
               RowBox[{"sortiesmma", "[", 
                RowBox[{"[", 
                 RowBox[{"index", ",", "j", ",", "5"}], "]"}], "]"}], "-", 
               RowBox[{"sortiesmma", "[", 
                RowBox[{"[", 
                 RowBox[{"index", ",", "j", ",", "4"}], "]"}], "]"}]}]}], ",", 
             RowBox[{"startanchor", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"startanchor", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"endanchor", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"endanchor", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "iptime", ",", "ipburn", 
             ",", "ipHoldff"}], "]"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"modsortie", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "12"}], "]"}], "]"}], "=", "ipburn"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"rfdelta", "=", 
            RowBox[{"ipburn", "+", 
             RowBox[{"sortiesmma", "[", 
              RowBox[{"[", 
               RowBox[{"index", ",", "j", ",", "7"}], "]"}], "]"}]}]}], ";", 
           RowBox[{"(*", " ", 
            RowBox[{"add", " ", "offload"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"modsortie", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "10"}], "]"}], "]"}], "=", 
            RowBox[{"Floor", "[", 
             RowBox[{"initfuel", "-", "lb", "-", "rfdelta"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"initfuel", "=", 
            RowBox[{"modsortie", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "10"}], "]"}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "2", ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"sortiesmma", "[", 
              RowBox[{"[", "index", "]"}], "]"}], "]"}], "-", "1"}]}], 
          "}"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"modsortie", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "4"}], "]"}], "]"}], "=", 
        RowBox[{"modsortie", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "5"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"aropPlan", "[", 
        RowBox[{"4", ",", "TankerEmptyWeight", ",", 
         RowBox[{"Floor", "[", 
          RowBox[{"modsortie", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "10"}], "]"}], "]"}], "]"}], ",", 
         "MaxTankerWeight", ",", "10000", ",", "0", ",", "3", ",", 
         RowBox[{"startanchor", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"startanchor", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"basecoords", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"basecoords", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", "0", 
         ",", "0", ",", 
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"modsortie", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"-", "2"}], ",", "6"}], "]"}], "]"}], "/", "100"}], 
          "]"}], ",", "0.0", ",", "time", ",", "burn", ",", "holdff"}], "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"hometime", "=", "time"}], ";", "\[IndentingNewLine]", 
       RowBox[{"homeburn", "=", "burn"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"modsortie", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "9"}], "]"}], "]"}], "=", 
        RowBox[{"modsortie", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "10"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"modsortie", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "10"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"modsortie", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "10"}], "]"}], "]"}], "-", 
         "homeburn"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"modsortie", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "5"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"modsortie", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "4"}], "]"}], "]"}], "+", "hometime"}]}],
        ";"}], "\[IndentingNewLine]", "}"}], ";", "\[IndentingNewLine]", 
     "modsortie"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.692570170611393*^9, 3.6925702980842943`*^9}, {
   3.692570328503481*^9, 3.692570337109439*^9}, {3.692570369088993*^9, 
   3.692570474503971*^9}, {3.692570570423675*^9, 3.692570634909416*^9}, 
   3.692570672315703*^9, {3.6925707535376167`*^9, 3.692570994133951*^9}, {
   3.692571044360729*^9, 3.692571045044029*^9}, {3.6925710846306562`*^9, 
   3.692571228649576*^9}, {3.692571320262062*^9, 3.692571321573296*^9}, {
   3.6925713535912333`*^9, 3.692571498440205*^9}, {3.6925716224024143`*^9, 
   3.692571668516692*^9}, {3.692571844262002*^9, 3.692571851419834*^9}, {
   3.692638089377116*^9, 3.692638113458552*^9}, {3.6926381929471235`*^9, 
   3.6926382038255014`*^9}, {3.69263828697338*^9, 3.6926382995392637`*^9}, {
   3.69263843373573*^9, 3.6926384354531975`*^9}, {3.6926385426131086`*^9, 
   3.6926385475346375`*^9}, {3.6926386155045843`*^9, 
   3.6926386435932198`*^9}, {3.6926387678924003`*^9, 
   3.6926387848748875`*^9}, {3.6926388237961407`*^9, 
   3.6926388249503007`*^9}, {3.6926389804578667`*^9, 3.692639027115637*^9}, {
   3.6926390651043406`*^9, 3.6926390656359434`*^9}, {3.6926391418145657`*^9, 
   3.6926392043093424`*^9}, {3.697852382568454*^9, 3.6978523945356426`*^9}, {
   3.697852564218321*^9, 3.6978525899222717`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"computesortiestats", "[", 
   RowBox[{"missionrecords_", ",", "tailnums_", ",", "index_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{"\"\<SORTIE\>\"", ",", 
    RowBox[{"tailnums", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "2"}], "]"}], "]"}], ",", "index", ",", 
    "\"\<917ARS\>\"", ",", " ", "1", ",", " ", "\"\<K135RT\>\"", ",", " ", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", 
       RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", 
         RowBox[{"-", "1"}], ",", "5"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"MaxTankerFuel", "/", "1000."}], ",", 
    RowBox[{"lf", "=", 
     RowBox[{
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", 
         RowBox[{"-", "1"}], ",", "10"}], "]"}], "]"}], "/", "1000."}]}], ",", 
    RowBox[{"mf", "=", 
     RowBox[{
      RowBox[{"MaxTankerFuel", "/", "1000."}], "-", "lf", "-", 
      RowBox[{"(", 
       RowBox[{"off", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"missionrecords", "[", 
            RowBox[{"[", 
             RowBox[{"index", ",", "j", ",", "7"}], "]"}], "]"}], "/", 
           "1000."}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"missionrecords", "[", 
              RowBox[{"[", "index", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
       ")"}]}]}], ",", "0.0", ",", 
    RowBox[{"lf", "-", "20.0"}], ",", 
    RowBox[{"elapsedtimeformat", "[", 
     RowBox[{
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", 
         RowBox[{"-", "1"}], ",", "5"}], "]"}], "]"}], "-", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{
       RowBox[{"missionrecords", "[", 
        RowBox[{"[", 
         RowBox[{"index", ",", 
          RowBox[{"-", "1"}], ",", "5"}], "]"}], "]"}], "+", 
       "BaseTurnTime"}]}], "]"}], ",", " ", "\"\<SORTIE\>\"", ",", ",", ",", 
    ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", 
         RowBox[{"-", "1"}], ",", "5"}], "]"}], "]"}]}], "]"}], ",", ",", ",",
     ",", ",", ",", 
    RowBox[{"-", "off"}], ","}], "}"}]}]], "Input",
 CellChangeTimes->{{3.68762351237624*^9, 3.687623518958592*^9}, {
   3.687623593971871*^9, 3.687623619199271*^9}, {3.687623677444097*^9, 
   3.6876238116282253`*^9}, {3.6876238515159273`*^9, 3.687623942935596*^9}, {
   3.687623973904551*^9, 3.687624076877746*^9}, {3.687624147970607*^9, 
   3.687624148820744*^9}, {3.687624202291862*^9, 3.687624213509704*^9}, {
   3.687624528340468*^9, 3.68762453034724*^9}, {3.687625343028453*^9, 
   3.687625433243094*^9}, {3.687625635090735*^9, 3.687625637031657*^9}, {
   3.6876257731665916`*^9, 3.6876257797644053`*^9}, {3.687625843948971*^9, 
   3.6876259100554647`*^9}, {3.687626036776173*^9, 3.687626047497367*^9}, {
   3.6876262610081043`*^9, 3.687626285213887*^9}, {3.687626844975271*^9, 
   3.687626848293972*^9}, {3.6876302212768097`*^9, 3.687630259464952*^9}, {
   3.687719226345448*^9, 3.687719235839398*^9}, {3.687719278839323*^9, 
   3.68771928239795*^9}, {3.687719314937194*^9, 3.687719315582753*^9}, {
   3.6900490384199257`*^9, 3.6900491164443913`*^9}, {3.6901404638037148`*^9, 
   3.690140471141283*^9}, {3.6901407109172697`*^9, 3.690140724930222*^9}, {
   3.69014278523346*^9, 3.690142801823084*^9}, {3.6926401985753393`*^9, 
   3.6926402194244785`*^9}, {3.6928037259649935`*^9, 3.6928037368565717`*^9}, 
   3.6978528178237453`*^9, {3.6978537065492816`*^9, 3.6978537065492816`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"createtakeoff", "[", 
   RowBox[{"missionrecords_", ",", "index_", ",", "bases_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
   "\"\<EVENT\>\"", ",", " ", ",", "index", ",", "\"\<917ARS\>\"", ",", ",", 
    "\"\<K135RT\>\"", ",", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", 
       RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", 
         RowBox[{"-", "1"}], ",", "5"}], "]"}], "]"}]}], "]"}], ",", ",", ",",
     ",", ",", ",", ",", ",", "\"\<TAKEOFF\>\"", ",", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"bases", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"bases", ",", 
          RowBox[{"missionrecords", "[", 
           RowBox[{"[", 
            RowBox[{"index", ",", "1", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "2"}], "]"}], "]"}], ",",
     ",", 
    RowBox[{"toff", "=", 
     RowBox[{"miltimeformat", "[", 
      RowBox[{"1", ",", "23", ",", 
       RowBox[{"missionrecords", "[", 
        RowBox[{"[", 
         RowBox[{"index", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}]}], ",", 
    "toff", ",", ",", ",", ",", ",", ",", ",", 
    RowBox[{
     RowBox[{"missionrecords", "[", 
      RowBox[{"[", 
       RowBox[{"index", ",", "1", ",", "10"}], "]"}], "]"}], "/", "1000."}]}],
    "}"}]}]], "Input",
 CellChangeTimes->{{3.687628368832325*^9, 3.687628385591984*^9}, {
  3.687628416062489*^9, 3.6876285819267397`*^9}, {3.687628761867138*^9, 
  3.687628882123361*^9}, {3.68762892699722*^9, 3.687628934437647*^9}, {
  3.6876290168897257`*^9, 3.687629018531736*^9}, {3.687629117762405*^9, 
  3.687629127103711*^9}, {3.687629275164049*^9, 3.687629275649797*^9}, {
  3.6876293475709743`*^9, 3.687629349042598*^9}, {3.6876296735198383`*^9, 
  3.687629678214666*^9}, {3.687629709306467*^9, 3.687629712081951*^9}, {
  3.690049126016518*^9, 3.6900491276539097`*^9}, {3.690140486814694*^9, 
  3.690140520388785*^9}, {3.690563483928329*^9, 3.690563499832498*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tankeronstation", "[", 
   RowBox[{"missionrecords_", ",", "index_", ",", "anchors_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
   "\"\<EVENT\>\"", ",", ",", "index", ",", "\"\<917ARS\>\"", ",", ",", 
    "\"\<K135RT\>\"", ",", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", 
       RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", 
         RowBox[{"-", "1"}], ",", "5"}], "]"}], "]"}]}], "]"}], ",", ",", ",",
     ",", ",", ",", ",", ",", "\"\<TANKER ON STATION\>\"", ",", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "2", ",", "3"}], "]"}], "]"}], ",", 
    RowBox[{"anchors", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"anchors", ",", 
          RowBox[{"missionrecords", "[", 
           RowBox[{"[", 
            RowBox[{"index", ",", "2", ",", "3"}], "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "5"}], "]"}], "]"}], ",", 
    RowBox[{"Floor", "[", 
     RowBox[{
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", "2", ",", "6"}], "]"}], "]"}], "/", "100."}], 
     "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", "1", ",", "5"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", 
         RowBox[{"-", "1"}], ",", "4"}], "]"}], "]"}]}], "]"}], ",", ",", ",",
     ",", ",", ",", ","}], "}"}]}]], "Input",
 CellChangeTimes->{{3.687630362891205*^9, 3.687630431698077*^9}, {
   3.6876304672104692`*^9, 3.687630520598464*^9}, {3.687630560657702*^9, 
   3.68763056761474*^9}, {3.687631018459111*^9, 3.6876310870717916`*^9}, {
   3.687631187739944*^9, 3.687631212659915*^9}, {3.687631249098735*^9, 
   3.687631260639368*^9}, 3.6876314395422497`*^9, {3.6876343684765673`*^9, 
   3.687634408700729*^9}, {3.687634517464641*^9, 3.687634522837167*^9}, {
   3.6876347515306263`*^9, 3.687634772449904*^9}, {3.6900491359309263`*^9, 
   3.690049138454713*^9}, {3.690073948221458*^9, 3.69007394892038*^9}, {
   3.690075369661455*^9, 3.690075377171101*^9}, {3.690140533263988*^9, 
   3.690140628028818*^9}, {3.6901406983782578`*^9, 3.6901407010526657`*^9}, {
   3.6901407354117317`*^9, 3.690140738615881*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tankeronstation1", "[", 
   RowBox[{"missionrecords_", ",", "index_", ",", "anchors_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "findzero", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"findzero", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"missionrecords", "[", 
              RowBox[{"[", 
               RowBox[{"index", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"missionrecords", "[", 
                 RowBox[{"[", "index", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", "0"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "}"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<EVENT\>\"", ",", ",", "index", ",", "\"\<917ARS\>\"", ",", ",", 
       "\"\<K135RT\>\"", ",", 
       RowBox[{"missionrecords", "[", 
        RowBox[{"[", 
         RowBox[{"index", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"missionrecords", "[", 
        RowBox[{"[", 
         RowBox[{"index", ",", 
          RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"miltimeformat", "[", 
        RowBox[{"1", ",", "23", ",", 
         RowBox[{"missionrecords", "[", 
          RowBox[{"[", 
           RowBox[{"index", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"miltimeformat", "[", 
        RowBox[{"1", ",", "23", ",", 
         RowBox[{"missionrecords", "[", 
          RowBox[{"[", 
           RowBox[{"index", ",", 
            RowBox[{"-", "1"}], ",", "5"}], "]"}], "]"}]}], "]"}], ",", ",", 
       ",", ",", ",", ",", ",", ",", "\"\<TANKER ON STATION\>\"", ",", 
       RowBox[{"missionrecords", "[", 
        RowBox[{"[", 
         RowBox[{"index", ",", "2", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{"anchors", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"anchors", ",", 
             RowBox[{"missionrecords", "[", 
              RowBox[{"[", 
               RowBox[{"index", ",", "2", ",", "3"}], "]"}], "]"}]}], "]"}], 
           "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "5"}], "]"}], "]"}], 
       ",", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"missionrecords", "[", 
          RowBox[{"[", 
           RowBox[{"index", ",", "2", ",", "6"}], "]"}], "]"}], "/", "100."}],
         "]"}], ",", 
       RowBox[{"miltimeformat", "[", 
        RowBox[{"1", ",", "23", ",", 
         RowBox[{"missionrecords", "[", 
          RowBox[{"[", 
           RowBox[{"index", ",", "1", ",", "5"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"miltimeformat", "[", 
        RowBox[{"1", ",", "23", ",", 
         RowBox[{"missionrecords", "[", 
          RowBox[{"[", 
           RowBox[{"index", ",", "findzero", ",", "4"}], "]"}], "]"}]}], 
        "]"}], ",", ",", ",", ",", ",", ",", ","}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6900739612606688`*^9, 3.690074020648341*^9}, {
  3.690074100153632*^9, 3.6900741017779617`*^9}, {3.6900741627611227`*^9, 
  3.690074186935276*^9}, {3.690075174863696*^9, 3.69007517805401*^9}, {
  3.690075439415247*^9, 3.690075440389862*^9}, {3.690140638092312*^9, 
  3.6901406855488243`*^9}, {3.6901407710428047`*^9, 3.690140798047595*^9}, {
  3.6902195594960337`*^9, 3.6902195601179047`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tankeronstation2", "[", 
   RowBox[{"missionrecords_", ",", "index_", ",", "anchors_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "findzero", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"findzero", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"missionrecords", "[", 
              RowBox[{"[", 
               RowBox[{"index", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"missionrecords", "[", 
                 RowBox[{"[", "index", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", "0"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "}"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<EVENT\>\"", ",", ",", "index", ",", "\"\<917ARS\>\"", ",", ",", 
       "\"\<K135RT\>\"", ",", 
       RowBox[{"missionrecords", "[", 
        RowBox[{"[", 
         RowBox[{"index", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"missionrecords", "[", 
        RowBox[{"[", 
         RowBox[{"index", ",", 
          RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"miltimeformat", "[", 
        RowBox[{"1", ",", "23", ",", 
         RowBox[{"missionrecords", "[", 
          RowBox[{"[", 
           RowBox[{"index", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"miltimeformat", "[", 
        RowBox[{"1", ",", "23", ",", 
         RowBox[{"missionrecords", "[", 
          RowBox[{"[", 
           RowBox[{"index", ",", 
            RowBox[{"-", "1"}], ",", "5"}], "]"}], "]"}]}], "]"}], ",", ",", 
       ",", ",", ",", ",", ",", ",", "\"\<TANKER ON STATION\>\"", ",", 
       RowBox[{"missionrecords", "[", 
        RowBox[{"[", 
         RowBox[{"index", ",", "findzero", ",", "3"}], "]"}], "]"}], ",", 
       RowBox[{"anchors", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"anchors", ",", 
             RowBox[{"missionrecords", "[", 
              RowBox[{"[", 
               RowBox[{"index", ",", "findzero", ",", "3"}], "]"}], "]"}]}], 
            "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "5"}], "]"}], "]"}], 
       ",", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"missionrecords", "[", 
          RowBox[{"[", 
           RowBox[{"index", ",", 
            RowBox[{"findzero", "+", "1"}], ",", "6"}], "]"}], "]"}], "/", 
         "100."}], "]"}], ",", 
       RowBox[{"miltimeformat", "[", 
        RowBox[{"1", ",", "23", ",", 
         RowBox[{"missionrecords", "[", 
          RowBox[{"[", 
           RowBox[{"index", ",", "findzero", ",", "5"}], "]"}], "]"}]}], 
        "]"}], ",", 
       RowBox[{"miltimeformat", "[", 
        RowBox[{"1", ",", "23", ",", 
         RowBox[{"missionrecords", "[", 
          RowBox[{"[", 
           RowBox[{"index", ",", 
            RowBox[{"-", "1"}], ",", "4"}], "]"}], "]"}]}], "]"}], ",", ",", 
       ",", ",", ",", ",", ","}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.690074142131196*^9, 3.6900741821617327`*^9}, {
  3.690074254400585*^9, 3.690074256871203*^9}, {3.690074376563249*^9, 
  3.6900744052668457`*^9}, {3.690074586676372*^9, 3.6900745877245827`*^9}, {
  3.690074707139641*^9, 3.690074722450391*^9}, {3.690074935252071*^9, 
  3.690074979999298*^9}, {3.6900750240025682`*^9, 3.690075044263389*^9}, {
  3.6900753843993063`*^9, 3.690075388373879*^9}, {3.690140810769416*^9, 
  3.690140851017852*^9}, {3.690219571070825*^9, 3.690219572068954*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rfevent", "[", 
   RowBox[{
   "missionrecords_", ",", "anchors_", ",", "index_", ",", "subindex_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
   "\"\<EVENT\>\"", ",", ",", "index", ",", "\"\<917ARS\>\"", ",", ",", 
    "\"\<K135RT\>\"", ",", "\[IndentingNewLine]", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", 
       RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", 
         RowBox[{"-", "1"}], ",", "5"}], "]"}], "]"}]}], "]"}], ",", ",", ",",
     ",", ",", ",", ",", ",", "\"\<FUEL OFFLOAD\>\"", ",", 
    "\[IndentingNewLine]", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "subindex", ",", "3"}], "]"}], "]"}], ",", 
    RowBox[{"anchors", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"anchors", ",", 
          RowBox[{"missionrecords", "[", 
           RowBox[{"[", 
            RowBox[{"index", ",", "subindex", ",", "3"}], "]"}], "]"}]}], 
         "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "5"}], "]"}], "]"}], ",", 
    RowBox[{"Floor", "[", 
     RowBox[{
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", "subindex", ",", "6"}], "]"}], "]"}], "/", 
      "100."}], "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", "subindex", ",", "4"}], "]"}], "]"}]}], "]"}], 
    ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", "subindex", ",", "5"}], "]"}], "]"}]}], "]"}], 
    ",", ",", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "subindex", ",", "13"}], "]"}], "]"}], ",", ",", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "subindex", ",", "15"}], "]"}], "]"}], ",", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "subindex", ",", "16"}], "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", "subindex", ",", "7"}], "]"}], "]"}]}], "/", 
     "1000."}], ",", 
    RowBox[{
     RowBox[{"missionrecords", "[", 
      RowBox[{"[", 
       RowBox[{"index", ",", "subindex", ",", "10"}], "]"}], "]"}], "/", 
     "1000."}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.687633352874621*^9, 3.687633402960888*^9}, {
   3.687633444039608*^9, 3.687633466073915*^9}, {3.687633499456276*^9, 
   3.687633552765748*^9}, {3.687633584630275*^9, 3.6876336124509172`*^9}, {
   3.687633649592895*^9, 3.6876337074121313`*^9}, {3.687633751754487*^9, 
   3.68763375895582*^9}, {3.6876337993492727`*^9, 3.687633848158369*^9}, {
   3.687633883815524*^9, 3.687633925357319*^9}, {3.687633973018426*^9, 
   3.687633979416934*^9}, {3.687634011004196*^9, 3.687634011369566*^9}, {
   3.687634117749447*^9, 3.687634124033824*^9}, {3.687634155941867*^9, 
   3.687634193310758*^9}, {3.687634297579987*^9, 3.6876343202537613`*^9}, 
   3.68763479535898*^9, {3.690077257311059*^9, 3.690077263821068*^9}, {
   3.6901409197701473`*^9, 3.690140954665783*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"firstrftable", "[", 
     RowBox[{"missionrecords_", ",", "index_", ",", "anchors_"}], "]"}], ":=",
     "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "findzero", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"findzero", "=", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"missionrecords", "[", 
                RowBox[{"[", 
                 RowBox[{"index", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"missionrecords", "[", 
                   RowBox[{"[", "index", "]"}], "]"}], "]"}]}], "}"}]}], 
              "]"}], ",", "0"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", "}"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"rfevent", "[", 
          RowBox[{
          "missionrecords", ",", "anchors", ",", "index", ",", "subindex"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"subindex", ",", "2", ",", 
           RowBox[{"findzero", "-", "1"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.690075735220208*^9, 3.690075907969874*^9}, {
  3.6900767326873817`*^9, 3.690076736276492*^9}, {3.690220024718598*^9, 
  3.6902200329657097`*^9}, {3.690220890181972*^9, 3.690220890569162*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"secondrftable", "[", 
     RowBox[{"missionrecords_", ",", "index_", ",", "anchors_"}], "]"}], ":=",
     "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "findzero", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"findzero", "=", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"missionrecords", "[", 
                RowBox[{"[", 
                 RowBox[{"index", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"missionrecords", "[", 
                   RowBox[{"[", "index", "]"}], "]"}], "]"}]}], "}"}]}], 
              "]"}], ",", "0"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", "}"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"rfevent", "[", 
          RowBox[{
          "missionrecords", ",", "anchors", ",", "index", ",", "subindex"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"subindex", ",", 
           RowBox[{"findzero", "+", "1"}], ",", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"missionrecords", "[", 
              RowBox[{"[", "index", "]"}], "]"}], "]"}], "-", "1"}]}], 
          "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.690076010249771*^9, 3.690076039534491*^9}, {
  3.6900761514786987`*^9, 3.690076153428546*^9}, {3.690076717957185*^9, 
  3.6900767209727182`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"createlanding", "[", 
   RowBox[{"missionrecords_", ",", "index_", ",", "bases_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
   "\"\<EVENT\>\"", ",", ",", "index", ",", "\"\<917ARS\>\"", ",", ",", 
    "\"\<K135RT\>\"", ",", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", 
       RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"miltimeformat", "[", 
     RowBox[{"1", ",", "23", ",", 
      RowBox[{"missionrecords", "[", 
       RowBox[{"[", 
        RowBox[{"index", ",", 
         RowBox[{"-", "1"}], ",", "5"}], "]"}], "]"}]}], "]"}], ",", ",", ",",
     ",", ",", ",", ",", ",", "\"\<LANDING\>\"", ",", 
    RowBox[{"missionrecords", "[", 
     RowBox[{"[", 
      RowBox[{"index", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"bases", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"bases", ",", 
          RowBox[{"missionrecords", "[", 
           RowBox[{"[", 
            RowBox[{"index", ",", "1", ",", "1"}], "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "2"}], "]"}], "]"}], ",",
     ",", 
    RowBox[{"tland", "=", 
     RowBox[{"miltimeformat", "[", 
      RowBox[{"1", ",", "23", ",", 
       RowBox[{"missionrecords", "[", 
        RowBox[{"[", 
         RowBox[{"index", ",", 
          RowBox[{"-", "1"}], ",", "5"}], "]"}], "]"}]}], "]"}]}], ",", 
    "tland", ",", ",", ",", ",", ",", ",", ",", 
    RowBox[{
     RowBox[{"missionrecords", "[", 
      RowBox[{"[", 
       RowBox[{"index", ",", 
        RowBox[{"-", "1"}], ",", "10"}], "]"}], "]"}], "/", "1000."}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.687629381612205*^9, 3.687629562504313*^9}, {
  3.6876295980646687`*^9, 3.687629613476721*^9}, {3.687629768890345*^9, 
  3.687629786288756*^9}, {3.6876298181755543`*^9, 3.687629819847842*^9}, {
  3.6876298830727587`*^9, 3.687629890257365*^9}, {3.687629926022743*^9, 
  3.687629927633754*^9}, {3.6876301668858547`*^9, 3.6876301682130337`*^9}, {
  3.6900491533802433`*^9, 3.690049154721753*^9}, {3.6901410626058817`*^9, 
  3.690141102564101*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tankertraverse", "[", 
   RowBox[{"missionrecords_", ",", "index_", ",", "anchors_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "findzero", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"findzero", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"missionrecords", "[", 
              RowBox[{"[", 
               RowBox[{"index", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"missionrecords", "[", 
                 RowBox[{"[", "index", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
           ",", "0"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "}"}], ";", "\[IndentingNewLine]", 
     StyleBox[
      RowBox[{"{", 
       RowBox[{
       "\"\<EVENT\>\"", ",", ",", "index", ",", "\"\<917ARS\>\"", ",", ",", 
        "\"\<K135RT\>\"", ",", 
        RowBox[{"missionrecords", "[", 
         RowBox[{"[", 
          RowBox[{"index", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"missionrecords", "[", 
         RowBox[{"[", 
          RowBox[{"index", ",", 
           RowBox[{"-", "1"}], ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"miltimeformat", "[", 
         RowBox[{"1", ",", "23", ",", 
          RowBox[{"missionrecords", "[", 
           RowBox[{"[", 
            RowBox[{"index", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"miltimeformat", "[", 
         RowBox[{"1", ",", "23", ",", 
          RowBox[{"missionrecords", "[", 
           RowBox[{"[", 
            RowBox[{"index", ",", 
             RowBox[{"-", "1"}], ",", "5"}], "]"}], "]"}]}], "]"}], ",", ",", 
        ",", ",", ",", ",", ",", ",", "\"\<ANCHOR TRAVERSE\>\"", ",", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
          RowBox[{"missionrecords", "[", 
           RowBox[{"[", 
            RowBox[{"index", ",", "findzero", ",", "2"}], "]"}], "]"}], ",", 
          "\"\</\>\"", ",", 
          RowBox[{"missionrecords", "[", 
           RowBox[{"[", 
            RowBox[{"index", ",", "findzero", ",", "3"}], "]"}], "]"}]}], 
         "]"}], ",", ",", ",", 
        RowBox[{"miltimeformat", "[", 
         RowBox[{"1", ",", "23", ",", 
          RowBox[{"missionrecords", "[", 
           RowBox[{"[", 
            RowBox[{"index", ",", "findzero", ",", "4"}], "]"}], "]"}]}], 
         "]"}], ",", 
        RowBox[{"miltimeformat", "[", 
         RowBox[{"1", ",", "23", ",", 
          RowBox[{"missionrecords", "[", 
           RowBox[{"[", 
            RowBox[{"index", ",", "findzero", ",", "5"}], "]"}], "]"}]}], 
         "]"}], ",", ",", ",", ",", ",", ",", ",", 
        RowBox[{
         RowBox[{"missionrecords", "[", 
          RowBox[{"[", 
           RowBox[{"index", ",", "findzero", ",", "10"}], "]"}], "]"}], "/", 
         "1000."}]}], "}"}],
      FontWeight->"Plain"]}]}], 
   StyleBox["\[IndentingNewLine]",
    FontWeight->"Plain"], 
   StyleBox["]",
    FontWeight->"Plain"]}]}]], "Input",
 CellChangeTimes->{{3.690071419275928*^9, 3.6900715203446417`*^9}, {
   3.6900716333636503`*^9, 3.690071653694292*^9}, {3.6900717964938173`*^9, 
   3.690071842681816*^9}, {3.6900719853019133`*^9, 3.690072039514089*^9}, {
   3.690072161681488*^9, 3.690072219522852*^9}, {3.69007225438617*^9, 
   3.6900723106846*^9}, {3.690072358411499*^9, 3.690072358634241*^9}, 
   3.6900724339122057`*^9, 3.690072545795446*^9, {3.690072576608259*^9, 
   3.690072592108637*^9}, {3.69007270744923*^9, 3.690072743372765*^9}, 
   3.690073638471925*^9, {3.690141114033189*^9, 3.6901411464449873`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"formatnoncombines", "[", 
    RowBox[{"data_", ",", "tails_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"computesortiestats", "[", 
           RowBox[{"data", ",", "tails", ",", "i"}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"createtakeoff", "[", 
           RowBox[{"data", ",", "i", ",", "bases"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"tankeronstation", "[", 
           RowBox[{"data", ",", "i", ",", "anchorlist"}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rfevent", "[", 
            RowBox[{"data", ",", "anchorlist", ",", "i", ",", "j"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2", ",", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"createlanding", "[", 
           RowBox[{"data", ",", "i", ",", "bases"}], "]"}], "}"}]}], 
        "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ",", "0"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.690049575251998*^9, 3.690049643875742*^9}, {
  3.690073088894948*^9, 3.690073103852089*^9}, {3.690073184767419*^9, 
  3.690073187230875*^9}, {3.6900732413855543`*^9, 3.6900732653303223`*^9}, {
  3.69007330892865*^9, 3.6900733464429827`*^9}, {3.690078181398632*^9, 
  3.690078184915886*^9}, {3.6926409128265405`*^9, 3.6926409211001644`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"formatcombines", "[", 
    RowBox[{
    "missionrecords_", ",", "bases_", ",", "anchors_", ",", "offset_"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"computesortiestats", "[", 
           RowBox[{"missionrecords", ",", "index"}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"createtakeoff", "[", 
           RowBox[{"missionrecords", ",", "index", ",", "bases"}], "]"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"tankeronstation1", "[", 
           RowBox[{"missionrecords", ",", "index", ",", "anchors"}], "]"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"firstrftable", "[", 
          RowBox[{"missionrecords", ",", "index", ",", "anchors"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"tankertraverse", "[", 
           RowBox[{"missionrecords", ",", "index", ",", "anchors"}], "]"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"tankeronstation2", "[", 
           RowBox[{"missionrecords", ",", "index", ",", "anchors"}], "]"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"secondrftable", "[", 
          RowBox[{"missionrecords", ",", "index", ",", " ", "anchors"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"createlanding", "[", 
           RowBox[{"missionrecords", ",", "index", ",", "bases"}], "]"}], 
          "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"index", ",", 
         RowBox[{"offset", "+", "1"}], ",", 
         RowBox[{"Length", "[", "missionrecords", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ",", "0"}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.690072942860614*^9, 3.690072965789371*^9}, 
   3.690073832062447*^9, {3.690076244261222*^9, 3.6900763556595078`*^9}, {
   3.690076392866556*^9, 3.690076581544221*^9}, {3.690076612559189*^9, 
   3.690076690678562*^9}, 3.690076787633876*^9, {3.690077334573388*^9, 
   3.69007733878889*^9}, {3.690077529120954*^9, 3.6900775762818193`*^9}, {
   3.690077608705978*^9, 3.6900776121975307`*^9}, {3.690077733356409*^9, 
   3.690077751707707*^9}, {3.690077787306675*^9, 3.690077790959425*^9}, {
   3.6902204001081*^9, 3.690220412566968*^9}, {3.690563578531006*^9, 
   3.6905635904425707`*^9}}],

Cell[CellGroupData[{

Cell["(*Windows Section*)", "Subsubtitle",
 CellChangeTimes->{{3.6925489240034637`*^9, 3.69254892691189*^9}, {
  3.6925490388201523`*^9, 3.692549043001317*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dllname", "=", 
  RowBox[{"FileNameJoin", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Directory", "[", "]"}], ",", "\"\<ato_dll.dll\>\""}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6809195151272078`*^9, 3.6809195434427395`*^9}, {
  3.6981865233462105`*^9, 3.698186524895919*^9}}],

Cell[BoxData["\<\"C:\\\\Users\\\\Chris\\\\Documents\\\\ato_dll.dll\"\>"], \
"Output",
 CellChangeTimes->{3.6981841008873477`*^9, 3.6981865754719777`*^9, 
  3.698187369512994*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<NETLink`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.6755384325878*^9, 3.6755384325878*^9}, 
   3.6797545494764*^9}],

Cell[BoxData[
 TemplateBox[{
  "DefineDLLFunction","shdw",
   "\"Symbol \\!\\(\\*RowBox[{\\\"\\\\\\\"DefineDLLFunction\\\\\\\"\\\"}]\\) \
appears in multiple contexts \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"\\\\\\\"NETLink`\\\\\\\"\\\", \\\",\\\", \
\\\"\\\\\\\"Global`\\\\\\\"\\\"}], \\\"}\\\"}]\\); definitions in context \\!\
\\(\\*RowBox[{\\\"\\\\\\\"NETLink`\\\\\\\"\\\"}]\\) may shadow or be shadowed \
by other definitions.\"",2,59,1,20788805050687986787,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.698187369679008*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aropPlan", "=", 
  RowBox[{"DefineDLLFunction", "[", 
   RowBox[{"\"\<aropPlan\>\"", ",", "dllname", ",", "\"\<int\>\"", ",", 
    RowBox[{"{", 
     RowBox[{
     "\"\<int\>\"", ",", "\"\<int\>\"", ",", "\"\<int\>\"", ",", 
      "\"\<int\>\"", ",", "\"\<int\>\"", ",", "\"\<int\>\"", ",", 
      "\"\<int\>\"", ",", "\"\<float\>\"", ",", "\"\<float\>\"", ",", 
      "\"\<float\>\"", ",", "\"\<float\>\"", ",", "\"\<int\>\"", ",", 
      "\"\<int\>\"", ",", "\"\<int\>\"", ",", "\"\<float\>\"", ",", 
      "\"\<out int\>\"", ",", "\"\<out int\>\"", ",", "\"\<out int\>\""}], 
     "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6749088805136003`*^9, 3.6749088805136003`*^9}, {
   3.6749089434284*^9, 3.6749089441772003`*^9}, {3.674908981118*^9, 
   3.6749089893236*^9}, {3.676762207736*^9, 3.6767622126344*^9}, {
   3.6767624278676*^9, 3.6767624310811996`*^9}, {3.6767625485024*^9, 
   3.6767625529796*^9}, {3.6785286738704*^9, 3.6785286741043997`*^9}, {
   3.6785287691552*^9, 3.6785287695764*^9}, {3.6785308022648*^9, 
   3.6785308024519997`*^9}, {3.679682831767*^9, 3.6796828324846*^9}, {
   3.6797514477144003`*^9, 3.6797514479484*^9}, {3.6797521921222*^9, 
   3.6797521959598*^9}, 3.6805337023128*^9, 3.6805466776864*^9, 
   3.6805468272320004`*^9, {3.6809196085746145`*^9, 3.6809196463746195`*^9}, {
   3.68096858944748*^9, 3.6809685922890177`*^9}, {3.680983289654646*^9, 
   3.6809832919360776`*^9}, {3.680986630671381*^9, 3.6809866315152493`*^9}, {
   3.680986689599518*^9, 3.680986693662447*^9}, {3.6981841125249877`*^9, 
   3.698184145210201*^9}, {3.6981841880176144`*^9, 3.698184193275548*^9}, {
   3.6981842757252617`*^9, 3.698184282133482*^9}, {3.698186535579892*^9, 
   3.6981865369503746`*^9}}],

Cell[BoxData[
 RowBox[{"Function", "[", 
  RowBox[{"Null", ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"NETLink`DLL`Private`checkArgCount", "[", 
      RowBox[{"\<\"aropPlan\"\>", ",", 
       RowBox[{"{", "##1", "}"}], ",", "18"}], "]"}], ",", 
     RowBox[{
     "Wolfram`NETLink`DynamicDLLNamespace`DLLWrapper1`aropPlan", "[", "##1", 
      "]"}], ",", "$Failed"}], "]"}], ",", 
   RowBox[{"{", "HoldAll", "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.698184129890009*^9, 3.698184146513131*^9}, 
   3.6981841947385874`*^9, 3.6981842834122224`*^9, 3.698184329318087*^9, {
   3.698187362204216*^9, 3.698187370480877*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aropHold", "=", 
  RowBox[{"DefineDLLFunction", "[", 
   RowBox[{
   "\"\<aropHold\>\"", ",", " ", "dllname", ",", "\[IndentingNewLine]", 
    "\"\<int\>\"", ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<int\>\"", ",", "\"\<int\>\"", ",", "\"\<int\>\"", ",", 
      "\"\<int\>\"", ",", "\"\<int\>\"", ",", "\"\<int\>\"", ",", 
      "\"\<int\>\"", ",", "\"\<float\>\"", ",", "\"\<float\>\""}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6785285436572*^9, 3.6785285954336*^9}, {
   3.6785306937200003`*^9, 3.6785307028616*^9}, {3.6785307506443996`*^9, 
   3.6785307619700003`*^9}, {3.6785319629144*^9, 3.678531963788*^9}, {
   3.679751463642*^9, 3.679751463876*^9}, 3.6805337050896*^9, 
   3.6805466703348*^9, 3.6805468295408*^9, {3.680920017132521*^9, 
   3.6809200470093093`*^9}, {3.6809869297961845`*^9, 3.680986962471496*^9}, {
   3.680986998787854*^9, 3.680986999225402*^9}, {3.6981865490751586`*^9, 
   3.6981865506769495`*^9}}],

Cell[BoxData[
 RowBox[{"Function", "[", 
  RowBox[{"Null", ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"NETLink`DLL`Private`checkArgCount", "[", 
      RowBox[{"\<\"aropHold\"\>", ",", 
       RowBox[{"{", "##1", "}"}], ",", "9"}], "]"}], ",", 
     RowBox[{
     "Wolfram`NETLink`DynamicDLLNamespace`DLLWrapper2`aropHold", "[", "##1", 
      "]"}], ",", "$Failed"}], "]"}], ",", 
   RowBox[{"{", "HoldAll", "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.69818431732331*^9, 3.6981873705284104`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"aropOffload", "=", 
  RowBox[{"DefineDLLFunction", "[", 
   RowBox[{
   "\"\<aropOffload\>\"", ",", " ", "dllname", ",", "\[IndentingNewLine]", 
    "\"\<int\>\"", ",", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<int\>\"", ",", "\"\<int\>\"", ",", "\"\<int\>\"", ",", 
      "\"\<int\>\"", ",", "\"\<int\>\"", ",", "\"\<int\>\"", ",", 
      "\"\<int\>\"", ",", "\"\<float\>\"", ",", "\"\<int\>\"", ",", 
      "\"\<int\>\"", ",", "\"\<float\>\"", ",", "\"\<float\>\"", ",", 
      "\"\<float\>\"", ",", "\"\<float\>\"", ",", "\"\<out int\>\"", ",", 
      "\"\<out int\>\"", ",", " ", "\"\<out int\>\""}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6785330174432*^9, 3.67853302256*^9}, {3.678533110388*^9,
    3.6785331243812*^9}, {3.6785334883915997`*^9, 3.67853349134*^9}, {
   3.6796821894681997`*^9, 3.679682217439*^9}, {3.6797526051816*^9, 
   3.6797526054468*^9}, 3.6805337067743998`*^9, 3.6805466721132*^9, 
   3.6805468310383997`*^9, 3.68092005355221*^9, {3.6809869525641947`*^9, 
   3.680986987208503*^9}, {3.6810501552677803`*^9, 3.6810501629789724`*^9}, {
   3.6981865560179787`*^9, 3.6981865604405546`*^9}}],

Cell[BoxData[
 RowBox[{"Function", "[", 
  RowBox[{"Null", ",", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"NETLink`DLL`Private`checkArgCount", "[", 
      RowBox[{"\<\"aropOffload\"\>", ",", 
       RowBox[{"{", "##1", "}"}], ",", "17"}], "]"}], ",", 
     RowBox[{
     "Wolfram`NETLink`DynamicDLLNamespace`DLLWrapper3`aropOffload", "[", 
      "##1", "]"}], ",", "$Failed"}], "]"}], ",", 
   RowBox[{"{", "HoldAll", "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.698184362745192*^9, 3.698187370562935*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"conflict", "[", 
   RowBox[{"apair_", ",", "bpair_", ",", "margin_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"bpair", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "<", 
     RowBox[{
      RowBox[{"apair", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "+", "margin"}]}], ",", 
    "\[IndentingNewLine]", "1", ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.688517058243219*^9, 3.688517100679319*^9}, {
  3.6885172242986593`*^9, 3.6885172295723743`*^9}, {3.6885763153687553`*^9, 
  3.6885763421992397`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Back to Normal section", "Subsubtitle",
 CellChangeTimes->{{3.6925489396319532`*^9, 3.692548943142932*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"altchooser", "[", 
   RowBox[{
   "events_", ",", "indexdictionary_", ",", "margin_", ",", "numalts_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"altarray", ",", "altcategory", ",", "altindices"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"altarray", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "numalts", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"altindices", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "numalts", "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "events", "]"}], "\[GreaterEqual]", "1"}], 
         ",", 
         RowBox[{"PrependTo", "[", 
          RowBox[{
           RowBox[{"altarray", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"events", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
       RowBox[{"(*", "Initialize", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "indexdictionary", "]"}], "\[GreaterEqual]", 
          "1"}], ",", 
         RowBox[{"PrependTo", "[", 
          RowBox[{"altindices", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"indexdictionary", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "}"}]}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ";", "\[IndentingNewLine]", 
           RowBox[{"While", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", 
                  RowBox[{"altarray", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "]"}], ">", "0"}], ",", 
                RowBox[{"conflict", "[", 
                 RowBox[{
                  RowBox[{"altarray", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", 
                  RowBox[{"events", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", "20"}], "]"}], ",", 
                "0"}], "]"}], "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
             RowBox[{"i", "+=", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"altarray", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"events", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"altindices", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"indexdictionary", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "2", ",", 
           RowBox[{"Length", "[", "events", "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Line", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"altarray", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"100", "i"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"altarray", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"100", "i"}]}], "}"}]}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "altarray", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"altarray", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
          "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"altarray", ",", "altindices"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQfXBO5Oa06teO887pHwbRNZevngbRRxSPPwbRbxYo
vgDRavd+gOkLi1U/gui6Ld3M6UBaI/8AD4juUdQRAdE7NljogOioBCswPcPu
sCOI/lf7FkzHfS3KAtEPikqqQXTAhPvTQbTfnd9g+pWhh3AGkL7fXWIEoi27
FyWD6LWLv6SBaLHLn+pA9MK1axpBtM/3GttsIH1p0xcw/a7wTDWIVhJMrgHR
7FE280A0U+vHBSB6nuXB2aVAmmXi/BUgWrn37FoQ7bNgzToQHf2TcyuI5vkV
B6YTG44fAtHBFrfANGfp6fcgumwh2wcQbRZXpVAG0i9uqgaivx3cEwSiV6hO
jAHR9nqCpr1Aet2SdDANAB1cv9E=
  "]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lowindices", "[", 
   RowBox[{"anchorno_", ",", "altitudes_"}], "]"}], ":=", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"altitudes", "[", "anchorno", "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}], "\[LessEqual]", "18000"}], 
        ",", "j", ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"altitudes", "[", "anchorno", "]"}], "]"}]}], "}"}]}], "]"}],
     ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"highindices", "[", 
   RowBox[{"anchorno_", ",", "altitudes_"}], "]"}], ":=", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"altitudes", "[", "anchorno", "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}], ">", "18000"}], ",", "j", 
        ",", "0"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", 
         RowBox[{"altitudes", "[", "anchorno", "]"}], "]"}]}], "}"}]}], "]"}],
     ",", "0"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6885837909327807`*^9, 3.688583987879329*^9}, {
  3.6885840267031927`*^9, 3.6885840383357196`*^9}, {3.688584262885106*^9, 
  3.688584273801382*^9}, {3.688655406275814*^9, 3.68865541006534*^9}, {
  3.6886554913368254`*^9, 3.6886554953432627`*^9}, {3.6925477270043488`*^9, 
  3.692547735553832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eventsfromindices", "[", 
    RowBox[{"altindex_", ",", "demand_", ",", "tankers_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"starttime", ",", "endtime"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"starttime", " ", "=", " ", 
         RowBox[{"demand", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"tankers", "[", 
             RowBox[{"[", 
              RowBox[{"altindex", ",", "2", ",", "1"}], "]"}], "]"}], ",", 
            "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"endtime", " ", "=", " ", 
         RowBox[{"demand", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"tankers", "[", 
             RowBox[{"[", 
              RowBox[{"altindex", ",", "2", ",", 
               RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "4"}], "]"}], 
          "]"}]}]}], "\[IndentingNewLine]", "}"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"starttime", ",", "endtime"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.692557418332741*^9, 3.692557672859235*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sortiealtset", "[", 
   RowBox[{
   "i_", ",", "lowaltsarray_", ",", "highaltsarray_", ",", "tankeralts_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sortiealts", ",", "provlow", ",", "provhigh"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"sortiealts", "=", "tankeralts"}], ";", "\[IndentingNewLine]", 
       RowBox[{"provlow", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"lowaltsarray", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"provhigh", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"highaltsarray", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lowalts", "=", 
        RowBox[{"{", 
         RowBox[{
         "16000", ",", "17000", ",", "18000", ",", "15000", ",", "19000", ",",
           "20000", ",", "21000"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"highalts", "=", 
        RowBox[{"{", 
         RowBox[{
         "25000", ",", "26000", ",", "27000", ",", "24000", ",", "28000", ",",
           "23000", ",", "29000", ",", "30000", ",", "22000"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"provlow", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"(*", " ", "lowalts", " ", "*)"}], 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sortiealts", "[", 
             RowBox[{"[", 
              RowBox[{"provlow", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}], "]"}], "]"}], "=", 
            RowBox[{"lowalts", "[", 
             RowBox[{"[", 
              RowBox[{"provlow", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "provlow", "]"}]}], "}"}]}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"provhigh", "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"(*", " ", 
          RowBox[{"high", " ", "alts"}], " ", "*)"}], 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sortiealts", "[", 
             RowBox[{"[", 
              RowBox[{"provhigh", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}], "]"}], "]"}], "=", 
            RowBox[{"highalts", "[", 
             RowBox[{"[", 
              RowBox[{"provhigh", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "provhigh", "]"}]}], "}"}]}], "]"}]}], 
        "]"}]}], "\[IndentingNewLine]", "}"}], ";", "\[IndentingNewLine]", 
     "sortiealts"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6886558338736753`*^9, 3.6886561284114313`*^9}, {
   3.688656205611347*^9, 3.688656308490923*^9}, {3.6886563484495144`*^9, 
   3.688656351623541*^9}, {3.6886563867854934`*^9, 3.688656395113475*^9}, {
   3.6886564278242664`*^9, 3.688656430796369*^9}, {3.6886569243514056`*^9, 
   3.6886569257366095`*^9}, {3.688657214667257*^9, 3.6886572318272686`*^9}, {
   3.688657268872488*^9, 3.688657273078169*^9}, {3.688657360844046*^9, 
   3.6886574008569736`*^9}, {3.6886575480519495`*^9, 
   3.6886575505919104`*^9}, {3.6886576057564154`*^9, 3.688657628899077*^9}, {
   3.688657855993617*^9, 3.6886580171015005`*^9}, {3.688658131533469*^9, 
   3.688658162421111*^9}, {3.688658258307294*^9, 3.6886582585608225`*^9}, {
   3.68865837326467*^9, 3.6886583738499136`*^9}, {3.688658830642313*^9, 
   3.688658881137678*^9}, {3.6886589752763863`*^9, 3.688658975560924*^9}, {
   3.6886590142880588`*^9, 3.6886590926551127`*^9}, {3.688659141278037*^9, 
   3.6886591440498734`*^9}, {3.688659236495675*^9, 3.688659236676014*^9}, {
   3.688659328384549*^9, 3.6886593400522985`*^9}, {3.688659386796712*^9, 
   3.6886593980378*^9}, {3.68865961290024*^9, 3.6886596467414045`*^9}, {
   3.688659722890848*^9, 3.6886597310828733`*^9}, {3.688659992011444*^9, 
   3.688660014202585*^9}, {3.6886601996351757`*^9, 3.6886602321888485`*^9}, {
   3.688660992733367*^9, 3.6886610607057486`*^9}, {3.6886612623694563`*^9, 
   3.6886612982671003`*^9}, {3.6886613311602216`*^9, 3.688661341739925*^9}, {
   3.6886613745356755`*^9, 3.6886614362753534`*^9}, {3.6886616219155235`*^9, 
   3.6886616321405115`*^9}, {3.688661694095854*^9, 3.688661711329962*^9}, {
   3.6886617719367895`*^9, 3.6886618056623807`*^9}, {3.688662589155851*^9, 
   3.6886626508275805`*^9}, {3.6886628708926888`*^9, 3.688662873663484*^9}, {
   3.6886630214912977`*^9, 3.688663027196474*^9}, {3.6886630672100134`*^9, 
   3.688663093159893*^9}, {3.688663134179759*^9, 3.6886631542665186`*^9}, {
   3.6886632139676127`*^9, 3.688663219340222*^9}, {3.688663357059959*^9, 
   3.6886633628417387`*^9}, {3.692559242673517*^9, 3.6925592520557632`*^9}, {
   3.692559382991021*^9, 3.692559385068781*^9}, {3.692559595144273*^9, 
   3.69255963212549*^9}, {3.6925599325298777`*^9, 3.692559935823945*^9}, {
   3.692559966026587*^9, 3.692559979121862*^9}, {3.692560009291313*^9, 
   3.692560015963464*^9}, {3.6925646216024303`*^9, 3.692564639325287*^9}, {
   3.692564851095784*^9, 3.692564853431919*^9}, {3.692564925362214*^9, 
   3.6925649258245153`*^9}, 3.6926376904203873`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"missiontails", "[", "tailassignpairs_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"flattable", ",", "reversedtable"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"flattable", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"tailassignpairs", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"reversedtable", "=", 
        RowBox[{"Sort", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"flattable", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
             RowBox[{"flattable", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "flattable", "]"}]}], "}"}]}], "]"}], 
         "]"}]}]}], "\[IndentingNewLine]", "}"}], ";", "\[IndentingNewLine]", 
     "reversedtable"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6926405091988416`*^9, 3.692640669527074*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.6926361118987536`*^9, 3.6981864406969376`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FileNames", "[", "]"}]], "Input",
 CellChangeTimes->{{3.691075954562621*^9, 3.691075958719363*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"aasi_cef.html\"\>", ",", "\<\"AASI_NetLink.dll\"\>", 
   ",", "\<\"advisory.png\"\>", ",", "\<\"airports.txt\"\>", 
   ",", "\<\"altanchorbasetimefuel.txt\"\>", 
   ",", "\<\"AltitudePlusHorizontalBasesImpinged.csv\"\>", 
   ",", "\<\"AltitudePlusHorizontalShifts.csv\"\>", 
   ",", "\<\"AltitudePlusHorizontalShiftsMultiDay.csv\"\>", 
   ",", "\<\"AltitudeShiftsBasesImpinged.csv\"\>", 
   ",", "\<\"AltitudeShiftsBasesImpingedMultiDay.csv\"\>", 
   ",", "\<\"AltitudeShifts.csv\"\>", 
   ",", "\<\"AltitudeShiftsMultiDay.csv\"\>", 
   ",", "\<\"AltitudeShifts_orig.csv\"\>", ",", "\<\"Anna\"\>", 
   ",", "\<\"Antech July 7.docx\"\>", ",", "\<\"Antech July 8.docx\"\>", 
   ",", "\<\"AR-ANCHOR-SYSTEM.csv\"\>", ",", "\<\"ArcGIS Explorer\"\>", 
   ",", "\<\"ATO ANCHORS.txt\"\>", ",", "\<\"ATO-BASES.csv\"\>", 
   ",", "\<\"ATO BASES.txt\"\>", ",", "\<\"ato.css\"\>", 
   ",", "\<\"ATO-Data-PART-1.xls\"\>", ",", "\<\"ato_dll.dll\"\>", 
   ",", "\<\"ato_dll.exp\"\>", ",", "\<\"ato_dll.lib\"\>", 
   ",", "\<\"ATO_Library.bsc\"\>", ",", "\<\"ATO_Library.dll\"\>", 
   ",", "\<\"ATO_Library.exp\"\>", ",", "\<\"ATO_Library.lib\"\>", 
   ",", "\<\"ATO MISSIONS.txt\"\>", ",", "\<\"BIOS_Acer_2.09_A_A\"\>", 
   ",", "\<\"CefApp.exe\"\>", ",", "\<\"CefApp.exe.pdb\"\>", 
   ",", "\<\"cef.pak\"\>", ",", "\<\"Cesium\"\>", 
   ",", "\<\"ChatLog AASI _ PIPER Cost Index Flying Conf Call 2014_06_26 \
15_36.rtf\"\>", 
   ",", "\<\"ChatLog AASI _ Rockwell Collins Conf Call _ Cost Index \
2014_12_04 14_14.rtf\"\>", ",", "\<\"Custom Office Templates\"\>", 
   ",", "\<\"d3dcompiler_43.dll\"\>", ",", "\<\"d3dcompiler_46.dll\"\>", 
   ",", "\<\"debug.log\"\>", ",", "\<\"Default.rdp\"\>", 
   ",", "\<\"demandCSV.csv\"\>", ",", "\<\"desktop.ini\"\>", 
   ",", "\<\"devtools_resources.pak\"\>", ",", "\<\"Dispatch.bsc\"\>", 
   ",", "\<\"Dispatch.dll\"\>", ",", "\<\"Dispatch.exp\"\>", 
   ",", "\<\"Dispatch.lib\"\>", ",", "\<\"Dispatch.pdb\"\>", 
   ",", "\<\"DYMO Label\"\>", ",", "\<\"edges.txt\"\>", ",", "\<\"ezvid\"\>", 
   ",", "\<\"ffmpegsumo.dll\"\>", ",", "\<\"Food web for computers.docx\"\>", 
   ",", "\<\"Freemake\"\>", ",", "\<\"help.png\"\>", 
   ",", "\<\"HorizontalConsolidation.csv\"\>", ",", "\<\"Ib roses.docx\"\>", 
   ",", "\<\"icudt.dll\"\>", ",", "\<\"IISExpress\"\>", 
   ",", "\<\"Inno Setup Examples Output\"\>", 
   ",", "\<\"jquery-2.1.1.min.js\"\>", 
   ",", "\<\"jquery.mobile-1.4.2.min.css\"\>", 
   ",", "\<\"jquery.mobile-1.4.2.min.js\"\>", 
   ",", "\<\"jquery.splitter-0.14.0.js\"\>", 
   ",", "\<\"jquery.splitter.css\"\>", ",", "\<\"KBIL_SCHED.txt\"\>", 
   ",", "\<\"KC135R_F108_VCI.DAT\"\>", ",", "\<\"KCPR_Sched.txt\"\>", 
   ",", "\<\"KFAR_Sched.txt\"\>", ",", "\<\"KGTF_Sched.txt\"\>", 
   ",", "\<\"Klondike 1897.docx\"\>", ",", "\<\"KTWF_Sched.txt\"\>", 
   ",", "\<\"lib\"\>", ",", "\<\"libcef.dll\"\>", ",", "\<\"libEGL.dll\"\>", 
   ",", "\<\"libGLESv2.dll\"\>", ",", "\<\"locales\"\>", ",", "\<\"logs\"\>", 
   ",", "\<\"ml32i4.dll\"\>", ",", "\<\"ml64i4.dll\"\>", 
   ",", "\<\"My CamStudio Temp Files\"\>", ",", "\<\"My CamStudio Videos\"\>",
    ",", "\<\"My Games\"\>", ",", "\<\"My Music\"\>", 
   ",", "\<\"My Pictures\"\>", ",", "\<\"mytaxexpress\"\>", 
   ",", "\<\"My Videos\"\>", ",", "\<\"My Web Sites\"\>", 
   ",", "\<\"NavDataService.dll\"\>", ",", "\<\"NavDataService.exp\"\>", 
   ",", "\<\"NavDataService.lib\"\>", ",", "\<\"NavDataService.pdb\"\>", 
   ",", "\<\"NavUtility.bsc\"\>", ",", "\<\"NavUtility.dll\"\>", 
   ",", "\<\"NavUtility.exp\"\>", ",", "\<\"NavUtility.lib\"\>", 
   ",", "\<\"NetLink_C.lib\"\>", ",", "\<\"NoXferCorrectAlts.csv\"\>", 
   ",", "\<\"NoXferSchedTailNos.csv\"\>", ",", "\<\"obj\"\>", 
   ",", "\<\"Outlook Files\"\>", ",", "\<\"outtimefuelmax2.csv\"\>", 
   ",", "\<\"outtimefuelmax.csv\"\>", ",", "\<\"outtimefuelmax.txt\"\>", 
   ",", "\<\"parseddemand.txt\"\>", ",", "\<\"pgadmin.log\"\>", 
   ",", "\<\"returntimefuelmax2.csv\"\>", 
   ",", "\<\"returntimefuelmax.csv\"\>", ",", "\<\"returntimefuelmax.txt\"\>",
    ",", "\<\"roses are awsome.docx\"\>", ",", "\<\"samsung\"\>", 
   ",", "\<\"SanteFe.docx\"\>", ",", "\<\"settings.png\"\>", 
   ",", "\<\"Snagit\"\>", ",", "\<\"Sorties.csv\"\>", 
   ",", "\<\"Sound recordings\"\>", ",", "\<\"TankerSchedule.log\"\>", 
   ",", "\<\"TankerSchedule_orig.log\"\>", 
   ",", "\<\"TankerSchedulerParameters\"\>", ",", "\<\"TankerSchedule.wl\"\>",
    ",", "\<\"TurningPoint 5\"\>", ",", "\<\"Visual Studio 2012\"\>", 
   ",", "\<\"wait.gif\"\>", ",", "\<\"Wolfram CDF Player\"\>", 
   ",", "\<\"Wolfram Mathematica\"\>", ",", "\<\"Wolfram.NETLink.dll\"\>", 
   ",", "\<\"~WRL3869.tmp\"\>", ",", "\<\"XmlUtility.bsc\"\>", 
   ",", "\<\"XmlUtility.dll\"\>", ",", "\<\"XmlUtility.exp\"\>", 
   ",", "\<\"XmlUtility.lib\"\>", ",", "\<\"~$tech July 8.docx\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6981873706715126`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"anchors", "=", 
   RowBox[{"Import", "[", "\"\<AR-ANCHOR-SYSTEM.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bases", "=", 
   RowBox[{"Import", "[", "\"\<ATO-BASES.csv\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"demand", "=", 
   RowBox[{
    RowBox[{"Import", "[", "\"\<ATO-Data-PART-1.xls\>\"", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.687636703269878*^9, 3.687636705593768*^9}, 
   3.68763674348081*^9, {3.687636825900016*^9, 3.687636843062586*^9}, {
   3.6910760144195023`*^9, 3.691076023027194*^9}, 3.6910760962705107`*^9, {
   3.691076624470173*^9, 3.691076624823214*^9}, {3.69107921653331*^9, 
   3.691079219185513*^9}, {3.6979002999436755`*^9, 3.6979003162106977`*^9}, {
   3.6979008239672136`*^9, 3.6979008578451014`*^9}, {3.6979009179540005`*^9, 
   3.6979009182539377`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"aabtf", "=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"Import", "[", "\"\<altanchorbasetimefuel.txt\>\"", "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parseddemand", "=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"Import", "[", "\"\<parseddemand.txt\>\"", "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.692569138116604*^9, 3.69256915349969*^9}, {
  3.692636256913679*^9, 3.6926362883252726`*^9}, {3.6926363953546667`*^9, 
  3.6926364008414574`*^9}, {3.692637886093899*^9, 3.692637886556938*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "aabtf", "]"}]], "Input",
 CellChangeTimes->{{3.6926362933812146`*^9, 3.6926362963525143`*^9}, {
  3.692636339954588*^9, 3.6926363573604555`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"16", ",", "23", ",", "5", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.6981873742983246`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"anchorlist", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ReadList", "[", 
        RowBox[{
         RowBox[{"StringToStream", "[", 
          RowBox[{"anchors", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", "Word"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3", ",", 
         RowBox[{"Length", "[", "anchors", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"startlatlongs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"convertplltodecimal", "[", 
          RowBox[{"parselatlong", "[", 
           RowBox[{"anchorlist", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "5"}], "]"}], "]"}], "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"anchorlist", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "anchorlist", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"endlatlongs", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"convertplltodecimal", "[", 
          RowBox[{"parselatlong", "[", 
           RowBox[{"anchorlist", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "6"}], "]"}], "]"}], "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"anchorlist", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "anchorlist", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"baselocs", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"convertplltodecimal", "[", 
          RowBox[{"parselatlong", "[", 
           RowBox[{"bases", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"bases", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{"Length", "[", "bases", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6618724093501043`*^9, 3.66187245844457*^9}, 
   3.662069171952388*^9, 3.6620695152428923`*^9, 3.662070132880539*^9, 
   3.691077076551331*^9, {3.691077657020403*^9, 3.69107769144734*^9}, {
   3.691080314922283*^9, 3.691080386380165*^9}}],

Cell["\<\
This divvies up demand table by anchor, the data are trimmed to get rid of  \
rows of null entries.\
\>", "Text",
 CellChangeTimes->{{3.6632643054007587`*^9, 3.663264310750511*^9}, {
   3.6654532878267307`*^9, 3.665453303735577*^9}, 3.691082935330133*^9}],

Cell["Samples", "Text",
 CellChangeTimes->{{3.69108308241763*^9, 3.691083083215049*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"parseddemand", " ", "=", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"pd", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Length", "[", "anchorlist", "]"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Table", " ", "to", " ", "store", " ", "anchor", " ", "parsed", " ", 
         "demand", " ", "data"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"startanchor", "=", 
        RowBox[{"demand", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"boot", " ", "up", " ", "with", " ", "first", " ", "anchor"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"j", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"demand", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], "\[Equal]", 
            "startanchor"}], ",", " ", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"pd", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             RowBox[{"demand", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"j", "<", 
                RowBox[{"Length", "[", "anchorlist", "]"}]}], ",", 
               RowBox[{"j", "++"}], ",", 
               RowBox[{"Break", "[", "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"startanchor", "=", 
              RowBox[{"demand", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{
               RowBox[{"pd", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"demand", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", " ", "724"}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "pd"}], 
      "\[IndentingNewLine]", "}"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.66317902764364*^9, 3.663179326855195*^9}, {
  3.663179379878048*^9, 3.6631794838989477`*^9}, {3.663206205380579*^9, 
  3.6632062061204147`*^9}, {3.66320631402726*^9, 3.663206343749064*^9}, {
  3.663206383296938*^9, 3.663206397515114*^9}, {3.663206459567565*^9, 
  3.6632064717470503`*^9}, {3.6632065097287083`*^9, 3.663206548726873*^9}, {
  3.6632637099102383`*^9, 3.663263737220117*^9}, {3.665453492027754*^9, 
  3.665453495853633*^9}, {3.691080414239368*^9, 3.6910804158875217`*^9}, {
  3.691080448218066*^9, 3.691080456982938*^9}, {3.691080580433165*^9, 
  3.691080581058333*^9}, {3.691080626210724*^9, 3.69108064786528*^9}, {
  3.691080812638424*^9, 3.691080815175531*^9}, {3.692636514649359*^9, 
  3.692636514951455*^9}, {3.6926373395700226`*^9, 3.692637344181981*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"theaterdemand", "=", 
   RowBox[{"theaterdemand", "[", "parseddemand", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.68563468187356*^9, 3.685634778939001*^9}, {
   3.685634812299563*^9, 3.6856348417872267`*^9}, {3.685634895926462*^9, 
   3.685634907059926*^9}, {3.685734609427812*^9, 3.6857346130145683`*^9}, {
   3.685735959983967*^9, 3.685735961855936*^9}, {3.6857360920577307`*^9, 
   3.6857360926306267`*^9}, {3.68575298094833*^9, 3.6857529841213207`*^9}, {
   3.6910786982135677`*^9, 3.6910787114586678`*^9}, {3.691078753297247*^9, 
   3.691078915657915*^9}, {3.691078974047544*^9, 3.691078993543199*^9}, {
   3.691081494612205*^9, 3.691081503212253*^9}, {3.691180896925433*^9, 
   3.691180920090851*^9}, 3.691785174451304*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{
      RowBox[{"theaterdemand", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "i"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "theaterdemand", "]"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.690855162697192*^9, 3.690855186914592*^9}}],

Cell["\<\
Same format as theaterdemand, but parsed out into all anchors\
\>", "Text",
 CellChangeTimes->{{3.691080880509413*^9, 3.691080890842946*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"theaterbyanchor", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"theaterdemand", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "i"}], "&"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "anchorlist", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.691079149377363*^9, 3.6910791657512283`*^9}, {
  3.691080895214571*^9, 3.691080898970274*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fivedays", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"dayshift", "[", 
          RowBox[{
           RowBox[{"parseddemand", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "4"}], "}"}]}], "]"}], ",", "1"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "23"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.691180671272483*^9, 3.691180689253172*^9}, {
  3.691180721079879*^9, 3.691180747352831*^9}, {3.6911810498941393`*^9, 
  3.691181050778878*^9}, {3.691197348078864*^9, 3.691197385111537*^9}, {
  3.691197820666514*^9, 3.6911978514485826`*^9}, {3.69119816164368*^9, 
  3.691198163053747*^9}, {3.691198522132266*^9, 3.691198522384234*^9}, {
  3.691198679285472*^9, 3.691198679771453*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fivetheaterdays", "=", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Format", ":", " ", 
     RowBox[{"{", 
      RowBox[{"anch", ",", " ", 
       RowBox[{"#", "_anch"}], ",", "t1", ",", "t2", ",", "alt", ",", "RFID", 
       ",", "N1", ",", "N2", ",", "ID3", ",", "ID4", ",", "Fuel", ",", 
       RowBox[{"#", "_theater"}]}], "}"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Sort", "[", 
    RowBox[{"(*", " ", 
     RowBox[{
     "time", " ", "is", " ", "000", " ", "hrs", " ", "at", " ", "beginning", 
      " ", "of", " ", "data", " ", "day"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"(*", " ", 
       RowBox[{
       "data", " ", "ordered", " ", "by", " ", "RF", " ", "start", " ", 
        "time", " ", 
        RowBox[{"(", "t1", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"anchno", ",", "i", ",", 
             RowBox[{
              RowBox[{"timeparse", "[", 
               RowBox[{"fivedays", "[", 
                RowBox[{"[", 
                 RowBox[{"anchno", ",", "i", ",", "2"}], "]"}], "]"}], "]"}], 
              "-", 
              RowBox[{"23", " ", "1440"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"timeparse", "[", 
               RowBox[{"fivedays", "[", 
                RowBox[{"[", 
                 RowBox[{"anchno", ",", "i", ",", "3"}], "]"}], "]"}], "]"}], 
              "-", 
              RowBox[{"23", " ", "1440"}]}], ",", 
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{"fivedays", "[", 
                RowBox[{"[", 
                 RowBox[{"anchno", ",", "i"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"4", ",", "10"}], "}"}]}], "]"}]}], "}"}], ",", "1"}],
           "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"anchno", ",", " ", 
           RowBox[{"Length", "[", "fivedays", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"fivedays", "[", 
             RowBox[{"[", "anchno", "]"}], "]"}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "1"}], "\[IndentingNewLine]", 
      "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#2", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ">", 
       RowBox[{"#1", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.691199401801947*^9, 3.69119943519072*^9}, {
  3.691199521484692*^9, 3.6911995508036747`*^9}, {3.6911998500426893`*^9, 
  3.691199865587254*^9}, {3.691200058822229*^9, 3.691200083935307*^9}, {
  3.691200122264213*^9, 3.691200161768486*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{
      RowBox[{"fivetheaterdays", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "i"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "fivetheaterdays", "]"}]}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.690855162697192*^9, 3.690855186914592*^9}, {
  3.691200221684123*^9, 3.691200225851705*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"theaterbyanchor5", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"fivetheaterdays", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "i"}], "&"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "anchorlist", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.691200499264305*^9, 3.691200511180081*^9}}],

Cell["\<\
Windows calculation to create a table for fuel to get from every base to \
every anchor and altitudes from FL150-FL300, assuming starting with a full \
fuel weight of 200klbs\
\>", "Text",
 CellChangeTimes->{{3.69108205848426*^9, 3.69108211157084*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"altanchorbasetimefuel", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"aropPlan", "[", 
          RowBox[{
          "4", ",", "TankerEmptyWeight", ",", "MaxTankerFuel", ",", 
           "MaxTankerWeight", ",", "10000", ",", "0", ",", "1", ",", 
           RowBox[{
            RowBox[{"baselocs", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "1"}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"baselocs", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "2"}], "]"}], "]"}], "/", "60."}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"baselocs", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "3"}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"baselocs", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "4"}], "]"}], "]"}], "/", "60."}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"startlatlongs", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "1"}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"startlatlongs", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}], "/", "60."}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"startlatlongs", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "3"}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"startlatlongs", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "4"}], "]"}], "]"}], "/", "60."}]}], ",", 
           "0", ",", "0", ",", 
           RowBox[{"140", " ", "+", " ", 
            RowBox[{"10", " ", "i"}]}], ",", "0.0", ",", "time", ",", "burn", 
           ",", "holdff"}], "]"}], ";", "time"}], ",", "burn"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "startlatlongs", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Length", "[", "baselocs", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{3.6978524045763483`*^9, 3.697852499374317*^9, 
  3.6978525720921135`*^9}],

Cell[TextData[StyleBox["Compute maxfuel to closest base for each anchor to \
use in first rough cut schedule.  This maximizes fuel burn over anchor \
arrival altitude",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.6801986016443996`*^9, 3.6801986096784*^9}, {
  3.6802036664552*^9, 3.6802036726015997`*^9}, {3.691082445193598*^9, 
  3.69108246860676*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"maxfuelbtoa", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"aabtf", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "16"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "startlatlongs", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Length", "[", "baselocs", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.680140172278*^9, 3.680140197784*^9}, {
   3.6801402279231997`*^9, 3.680140228906*^9}, {3.6801402752848*^9, 
   3.680140293802*^9}, {3.6801403303216*^9, 3.6801404590216*^9}, {
   3.6801405833068*^9, 3.6801406525552*^9}, 3.680140702834*^9, 
   3.68014082194*^9, {3.680140951966*^9, 3.6801409859428*^9}, {
   3.6875559965850406`*^9, 3.6875560021421227`*^9}}],

Cell["\<\
Windows calculation to compute fuel required to get home.  Conservative \
methodology:  Fuel to get from base to anchor is always greater than fuel to \
get home because of descent vs. ascent and lower weight vs. higher wt.  So \
use as a start weight upon anchor departure the minimum fuel required upon \
return (20klbs) plus the fuel burn required for the fully laden outbound \
trip.  The return to base weight will then always be greater than 20klbs.\
\>", "Text",
 CellChangeTimes->{{3.691082148430046*^9, 3.691082277599657*^9}, {
  3.691083309874938*^9, 3.69108332121856*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"returnfuelest", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"aropPlan", "[", 
          RowBox[{"4", ",", "TankerEmptyWeight", ",", 
           RowBox[{"MinReturnTankerFuel", "+", 
            RowBox[{"aabtf", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}]}], 
           ",", "MaxTankerWeight", ",", "10000", ",", "0", ",", "3", ",", 
           RowBox[{
            RowBox[{"startlatlongs", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "1"}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"startlatlongs", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}], "/", "60."}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"startlatlongs", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "3"}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"startlatlongs", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "4"}], "]"}], "]"}], "/", "60."}]}], ",", 
           RowBox[{
            RowBox[{"baselocs", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "1"}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"baselocs", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "2"}], "]"}], "]"}], "/", "60."}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"baselocs", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "3"}], "]"}], "]"}], "+", 
            RowBox[{
             RowBox[{"baselocs", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "4"}], "]"}], "]"}], "/", "60."}]}], ",", 
           "\[IndentingNewLine]", "0", ",", "0", ",", 
           RowBox[{"140", " ", "+", " ", 
            RowBox[{"10", " ", "i"}]}], ",", "0.0", ",", "time", ",", "burn", 
           ",", "holdff"}], "]"}], ";", "time"}], ",", "burn"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "startlatlongs", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Length", "[", "baselocs", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.691082690562606*^9, 3.691082706751893*^9}, 
   3.6978524102504206`*^9, 3.6978525818312874`*^9, 3.697854321427355*^9}],

Cell["\<\
Pick out the altitude that generates the biggest fuel burn, return time and \
fuel at that altitude\
\>", "Text",
 CellChangeTimes->{{3.6910828667751913`*^9, 3.6910828911565323`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"returntimefuelmax", "=", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"at", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"returnfuelest", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "16"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"a", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"at", ",", 
           RowBox[{"Max", "[", "at", "]"}]}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"returnfuelest", "[", 
          RowBox[{"[", 
           RowBox[{"a", ",", "j", ",", "k", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"returnfuelest", "[", 
          RowBox[{"[", 
           RowBox[{"a", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}]}], 
        "}"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "startlatlongs", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{"Length", "[", "baselocs", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.698075204427141*^9, 3.698075205875901*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<outtimefuelmax2.csv\>\"", ",", "otfm"}], "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<returntimefuelmax2.csv\>\"", ",", "rtfm"}], "]"}], ";"}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.698075260410924*^9, 3.6980752900563555`*^9}, {
  3.6980753677614284`*^9, 3.6980753748035965`*^9}, {3.698075406218071*^9, 
  3.6980754072504106`*^9}, {3.6980754482979207`*^9, 3.6980754673641005`*^9}, {
  3.6980755894955587`*^9, 3.698075593099003*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"otfm", "=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"Import", "[", "\"\<outtimefuelmax2.csv\>\"", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rtfm", "=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"Import", "[", "\"\<returntimefuelmax2.csv\>\"", "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.691522375982011*^9, 3.691522380871654*^9}, {
  3.691523658697671*^9, 3.6915236643448563`*^9}, {3.692120223999605*^9, 
  3.692120231771695*^9}, {3.6980741326990614`*^9, 3.698074155891858*^9}, {
  3.6980743090241933`*^9, 3.6980744012999935`*^9}, {3.698074452515443*^9, 
  3.6980745332639494`*^9}, {3.6980745821004467`*^9, 3.69807458384799*^9}, {
  3.6980747781431923`*^9, 3.6980747894070997`*^9}, {3.6980748670332546`*^9, 
  3.6980748808779926`*^9}, {3.6980749475589776`*^9, 3.6980749846997604`*^9}, {
  3.698075119869282*^9, 3.6980751238744044`*^9}, {3.6980754849344354`*^9, 
  3.698075515748268*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"baseordering", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Ordering", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"otfm", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"otfm", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "23"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"outfuel3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"otfm", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "/", "1000."}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outtime3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"otfm", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intime3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"rtfm", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"infuel3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"rtfm", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "/", "1000."}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6921204621387987`*^9, 3.692120464695692*^9}, {
   3.692122140833623*^9, 3.6921221796634293`*^9}, {3.692122335826438*^9, 
   3.692122336033352*^9}, 3.692123769454485*^9, {3.6923070213772717`*^9, 
   3.6923071184848213`*^9}, {3.6923071583825903`*^9, 3.692307284144845*^9}, {
   3.692307661682089*^9, 3.692307675921109*^9}, {3.692307777392415*^9, 
   3.692307792726927*^9}, 3.692458686802404*^9, {3.692483258626464*^9, 
   3.692483268803184*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"generatescheduletheaterMma8", "[", 
    RowBox[{"test_", ",", "minintervalbetweenRFs_", ",", "maxwaitafterRF_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "fa", ",", "cf", ",", "nr", ",", "remainingrequests", ",", "tankers", 
        ",", "rfdurs", ",", "offloads", ",", "tankerscores", ",", "eventlist",
         ",", "tankersinplay", ",", "tmax", ",", "departingtanker", ",", 
        "currentbasing", ",", "newbase", ",", "ts"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"(*", " ", 
        RowBox[{"Generate", " ", "RF", " ", "schedule"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "This", " ", "version", " ", "keeps", " ", "track", " ", "of", " ", 
         "tankersinplay", " ", "and", " ", "keeps", " ", "a", " ", "running", 
         " ", "eventlist", " ", "and", " ", "does", " ", "dynamic", " ", 
         "basing"}], " ", "*)"}], "\n", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"fa", "=", 
         RowBox[{"firstavailbytheater2", "[", 
          RowBox[{
          "test", ",", "minintervalbetweenRFs", ",", "maxwaitafterRF"}], 
          "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"nr", "=", 
         RowBox[{"Length", "[", "test", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tankers", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"{", "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "nr"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rfdurs", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"test", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "4"}], "]"}], "]"}], "-", 
            RowBox[{"test", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nr"}], "}"}]}], "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{"duration", " ", "of", " ", "refuelings"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"offloads", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"test", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "11"}], "]"}], "]"}], "/", "1000."}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nr"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tankerscores", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "nr", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Initialization", " ", "of", " ", "algorithm"}], " ", "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"tankersinplay", "=", 
         RowBox[{"{", "1", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"tankers", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", "1"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{
          RowBox[{"tankers", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"baseordering", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}], 
             "]"}], ",", 
            RowBox[{"test", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tankerscores", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "=", 
         RowBox[{"mmaholdoffloadk", "[", 
          RowBox[{"10", ",", 
           RowBox[{"rfdurs", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"MaxTankerFuel", "/", "1000."}], "-", 
            RowBox[{"outfuel3", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"tankers", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "3", ",", "2"}], "]"}], "]"}], ",", 
               RowBox[{"tankers", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "3", ",", "1"}], "]"}], "]"}]}], "]"}], 
             "]"}]}], ",", 
           RowBox[{"offloads", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tmax", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"eventlist", "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"tankers", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"tankers", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"test", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "3"}], "]"}], "]"}], "-", "10", "-", 
             RowBox[{"outtime3", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"tankers", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "3", ",", "2"}], "]"}], "]"}], ",", 
                RowBox[{"tankers", "[", 
                 RowBox[{"[", 
                  RowBox[{"1", ",", "3", ",", "1"}], "]"}], "]"}]}], "]"}], 
              "]"}]}], ",", 
            RowBox[{"-", "1"}]}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"The", " ", "Flow", " ", "Scheduler"}], " ", "*)"}], 
        "\[IndentingNewLine]", " ", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"t", " ", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
            " ", 
            RowBox[{"(*", " ", 
             RowBox[{
             "Start", " ", "sweep", " ", "with", " ", "first", " ", 
              "tankerinplay", " ", "every", " ", "time"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"While", "[", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "If", " ", "time", " ", "OR", " ", "fuel", " ", "condition", 
                " ", "OR", " ", "anchor", " ", "match", " ", "OR", " ", 
                "follow", " ", "on", " ", "fails"}], ",", " ", 
               RowBox[{"move", " ", "to", " ", "next", " ", "tanker"}]}], " ",
               "*)"}], " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", "\[IndentingNewLine]", 
                RowBox[{"If", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
                    "]"}], "\[GreaterEqual]", "1"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"fa", "[", 
                    RowBox[{"[", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], ",", "2", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "]"}], ">", 
                    "j"}], "||", 
                   RowBox[{
                    RowBox[{"fa", "[", 
                    RowBox[{"[", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], ",", "2", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", "}"}]}], "||", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"tankerscores", "[", 
                    RowBox[{"[", 
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "]"}], "]"}], "+", 
                    RowBox[{"mmaholdoffloadk", "[", 
                    RowBox[{
                    RowBox[{"rftimeintervals2", "[", 
                    RowBox[{"test", ",", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], ",", "2", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "j"}], "]"}], 
                    ",", 
                    RowBox[{"rfdurs", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"MaxTankerFuel", "/", "1000."}], "-", 
                    RowBox[{"tankerscores", "[", 
                    RowBox[{"[", 
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "]"}], "]"}]}], ",", " ", 
                    RowBox[{"offloads", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], 
                    "\[GreaterEqual]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"MaxTankerFuel", "-", "MinReturnTankerFuel"}], 
                    ")"}], "/", "1000."}], "-", 
                    RowBox[{"outfuel3", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], ",", "3", ",", "2"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], ",", "3", ",", "1"}], 
                    "]"}], "]"}]}], "]"}], "]"}], "-", 
                    RowBox[{"infuel3", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], ",", "3", ",", "2"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], ",", "3", ",", "1"}], 
                    "]"}], "]"}]}], "]"}], "]"}]}]}], "||", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"test", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "\[NotEqual]", 
                    RowBox[{"test", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], ",", "2", ",", "1"}], 
                    "]"}], "]"}], ",", "1"}], "]"}], "]"}]}]}], ",", 
                  "\[IndentingNewLine]", " ", "False"}], 
                 "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ")"}], 
               " ", "&&", " ", 
               RowBox[{"t", "<=", 
                RowBox[{"Length", "[", "tankersinplay", "]"}]}]}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"t", "+=", "1"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"t", ">", 
                   RowBox[{"Length", "[", "tankersinplay", "]"}]}], ",", " ", 
                  RowBox[{"Break", "[", "]"}]}], "]"}]}], 
               "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"(*", " ", 
              RowBox[{
              "Assignment", " ", "section", " ", "for", " ", "instantiation", 
               " ", "of", " ", "new", " ", "tanker"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"t", ">", 
               RowBox[{"Length", "[", "tankersinplay", "]"}]}], ",", " ", 
              "\[IndentingNewLine]", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"tmax", " ", "=", " ", 
                 RowBox[{"tmax", "+", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"currentbasing", "=", 
                 RowBox[{"fastbase", "[", 
                  RowBox[{"eventlist", ",", 
                   RowBox[{
                    RowBox[{"test", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}], "-", "50"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"newbase", "=", 
                 RowBox[{"dynamicbaseassign", "[", 
                  RowBox[{"currentbasing", ",", "basecapacities", ",", 
                   RowBox[{"baseordering", "[", 
                    RowBox[{"[", 
                    RowBox[{"test", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"Print", "[", 
                   RowBox[{
                   "\"\<currentbasing = \>\"", ",", " ", "currentbasing"}], 
                   "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"Print", "[", 
                   RowBox[{"\"\<newbase = \>\"", ",", " ", "newbase"}], "]"}],
                   ";"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"tankersinplay", ",", "tmax"}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{
                  RowBox[{"tankers", "[", 
                   RowBox[{"[", "tmax", "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"newbase", ",", 
                    RowBox[{"test", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"eventlist", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], ",", "newbase", ",", 
                    RowBox[{"test", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"test", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}], "-", "10", "-", 
                    RowBox[{"outtime3", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], ",", "3", ",", "2"}], 
                    "]"}], "]"}], ",", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], ",", "3", ",", "1"}], 
                    "]"}], "]"}]}], "]"}], "]"}]}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], 
            ";", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Launch", " ", "new", " ", "tanker"}], ",", " ", 
              RowBox[{"record", " ", "in", " ", "eventlist"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{"tankers", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"tankersinplay", "[", 
                  RowBox[{"[", "t", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
              ",", "j"}], "]"}], ";", " ", 
            RowBox[{"(*", " ", 
             RowBox[{"Append", " ", "acceptable", " ", "rf", " ", "to", " ", 
              RowBox[{"(", 
               RowBox[{"old", " ", "or", " ", "new"}], ")"}], " ", "tanker"}],
              " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"(*", " ", 
              RowBox[{"Do", " ", "fuel", " ", "accounting"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"tankers", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], ",", "2"}], "]"}], "]"}], 
                "]"}], ">=", "2"}], ",", 
              RowBox[{
               RowBox[{"tankerscores", "[", 
                RowBox[{"[", 
                 RowBox[{"tankersinplay", "[", 
                  RowBox[{"[", "t", "]"}], "]"}], "]"}], "]"}], "+=", 
               RowBox[{"mmaholdoffloadk", "[", 
                RowBox[{
                 RowBox[{"rftimeintervals2", "[", 
                  RowBox[{"test", ",", 
                   RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], ",", "2", ",", 
                    RowBox[{"-", "2"}]}], "]"}], "]"}], ",", "j"}], "]"}], 
                 ",", 
                 RowBox[{"rfdurs", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"MaxTankerFuel", "/", "1000."}], "-", 
                  RowBox[{"tankerscores", "[", 
                   RowBox[{"[", 
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "]"}], "]"}]}], ",", 
                 RowBox[{"offloads", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ",", " ", 
              RowBox[{"(*", " ", 
               RowBox[{
               "loiter", " ", "plus", " ", "offload", " ", "calculation", " ",
                 "for", " ", "old", " ", "tanker"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"tankerscores", "[", 
                RowBox[{"[", 
                 RowBox[{"tankersinplay", "[", 
                  RowBox[{"[", "t", "]"}], "]"}], "]"}], "]"}], "+=", 
               RowBox[{"mmaholdoffloadk", "[", 
                RowBox[{"10", ",", 
                 RowBox[{"rfdurs", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"MaxTankerFuel", "/", "1000."}], "-", 
                  RowBox[{"tankerscores", "[", 
                   RowBox[{"[", 
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "t", "]"}], "]"}], "]"}], "]"}]}], ",", 
                 RowBox[{"offloads", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{"offload", " ", "only", " ", "calculation", " ", 
              RowBox[{"w", "/", "10"}], " ", "minute", " ", "early", " ", 
              "arrival", " ", "for", " ", "new", " ", "tanker"}], " ", "*)"}],
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", 
             RowBox[{"(*", " ", 
              RowBox[{"De", "-", 
               RowBox[{
               "assignment", " ", "section", " ", "for", " ", "retiring", " ",
                 "of", " ", "old", " ", "tanker"}]}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"fa", "[", 
                   RowBox[{"[", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "tp", "]"}], "]"}], ",", "2", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "]"}], 
                  "\[Equal]", 
                  RowBox[{"{", "}"}]}], "||", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"test", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "3"}], "]"}], "]"}], ">", 
                  RowBox[{
                   RowBox[{"test", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "tp", "]"}], "]"}], ",", "2", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "4"}], "]"}], 
                    "]"}], "+", "maxwaitafterRF"}]}]}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "Remove", " ", "tankers", " ", "from", " ", "tankersinplay", 
                  " ", "if", " ", "sent", " ", "home"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"departingtanker", "=", 
                   RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "tp", "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"eventlist", ",", "\[IndentingNewLine]", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "tp", "]"}], "]"}], ",", "1"}], "]"}], "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "tp", "]"}], "]"}], ",", "3", ",", "1"}], 
                    "]"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "tp", "]"}], "]"}], ",", "3", ",", "2"}], 
                    "]"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"test", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "tp", "]"}], "]"}], ",", "2", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "4"}], "]"}], 
                    "]"}], "+", 
                    RowBox[{"intime3", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{"departingtanker", ",", "3", ",", "2"}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{"departingtanker", ",", "3", ",", "1"}], "]"}], 
                    "]"}]}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    "1"}], "\[IndentingNewLine]", "}"}]}], "]"}], ";", 
                  RowBox[{"(*", " ", 
                   RowBox[{"Eventlist", ":", " ", 
                    RowBox[{"return", " ", "to", " ", "base"}]}], " ", "*)"}],
                   "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"eventlist", ",", "\[IndentingNewLine]", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "tp", "]"}], "]"}], ",", "1"}], "]"}], "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "tp", "]"}], "]"}], ",", "3", ",", "1"}], 
                    "]"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "tp", "]"}], "]"}], ",", "3", ",", "2"}], 
                    "]"}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"test", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "tp", "]"}], "]"}], ",", "2", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "4"}], "]"}], 
                    "]"}], "+", 
                    RowBox[{"intime3", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{"departingtanker", ",", "3", ",", "2"}], "]"}], 
                    "]"}], ",", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{"departingtanker", ",", "3", ",", "1"}], "]"}], 
                    "]"}]}], "]"}], "]"}], "+", "BaseTurnTime"}], ",", 
                    "\[IndentingNewLine]", "2"}], "\[IndentingNewLine]", 
                    "}"}]}], "]"}], ";", 
                  RowBox[{"(*", " ", 
                   RowBox[{"Eventlist", ":", " ", 
                    RowBox[{"available", " ", "for", " ", "redeployment"}]}], 
                   " ", "*)"}], "\[IndentingNewLine]", 
                  RowBox[{"tankersinplay", "=", 
                   RowBox[{"DeleteCases", "[", 
                    RowBox[{"tankersinplay", ",", 
                    RowBox[{"tankers", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "tp", "]"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "This", " ", "is", " ", "only", " ", "done", " ", "once", 
                    " ", "per", " ", "RF", " ", "event", " ", "loop", " ", 
                    "because", " ", "only", " ", "one", " ", "tanker", " ", 
                    "max", " ", "per", " ", "loop", " ", "is", " ", "retired",
                     " ", "in", " ", "flow", " ", "scheduling"}], " ", "*)"}],
                   "\[IndentingNewLine]", 
                  RowBox[{"Break", "[", "]"}]}], "\[IndentingNewLine]", 
                 "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"tp", ",", 
                RowBox[{"Length", "[", "tankersinplay", "]"}]}], "}"}]}], " ",
              "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "2", ",", "nr"}], "}"}]}], "\[IndentingNewLine]",
          "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Finish", " ", "up", " ", "eventlist"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"eventlist", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"tankers", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"tankersinplay", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"tankers", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"tankersinplay", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], ",", "3", ",", "1"}], "]"}],
                "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"tankers", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"tankersinplay", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], ",", "3", ",", "2"}], "]"}],
                "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"tankers", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "2", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "4"}], "]"}], 
                "]"}], "+", 
               RowBox[{"intime3", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"tankers", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "3", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"tankers", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "3", ",", "1"}], "]"}], "]"}]}], "]"}], 
                "]"}]}], ",", "\[IndentingNewLine]", "1"}], 
             "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Length", "[", "tankersinplay", "]"}]}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"eventlist", ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"tankers", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"tankersinplay", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"tankers", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"tankersinplay", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], ",", "3", ",", "1"}], "]"}],
                "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"tankers", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"tankersinplay", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], ",", "3", ",", "2"}], "]"}],
                "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"test", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"tankers", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"tankersinplay", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "2", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], ",", "4"}], "]"}], 
                "]"}], "+", 
               RowBox[{"intime3", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"tankers", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "3", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"tankers", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "3", ",", "1"}], "]"}], "]"}]}], "]"}], 
                "]"}], "+", "BaseTurnTime"}], ",", "\[IndentingNewLine]", 
              "2"}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", 
            RowBox[{"Length", "[", "tankersinplay", "]"}]}], "}"}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<End tankersinplay = \>\"", ",", " ", "tankersinplay"}], "]"}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Length of eventlist = \>\"", ",", " ", 
            RowBox[{"Length", "[", "eventlist", "]"}]}], "]"}], ";"}], "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Clean", " ", "up"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tankers", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"tankers", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "tmax"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"tankers", ",", 
          RowBox[{"Sort", "[", 
           RowBox[{"eventlist", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#2", "[", 
               RowBox[{"[", "4", "]"}], "]"}], ">", 
              RowBox[{"#1", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "&"}]}], "]"}], ",", "tmax", 
          ",", 
          RowBox[{"ts", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"tankerscores", ",", "0"}], "]"}]}], ",", 
          RowBox[{"Plus", "@@", "ts"}]}], "}"}]}], "\[IndentingNewLine]", 
       "}"}]}], "\[IndentingNewLine]", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6910841581014442`*^9, 3.691084164570794*^9}, {
   3.691084563984769*^9, 3.691084574791429*^9}, {3.691084606443194*^9, 
   3.69108461952913*^9}, {3.6910848888138723`*^9, 3.691084891373879*^9}, {
   3.691084999807673*^9, 3.6910850193902884`*^9}, {3.691085099160131*^9, 
   3.6910850995611057`*^9}, {3.69108512977662*^9, 3.691085198454508*^9}, {
   3.6910854497326307`*^9, 3.6910854549948063`*^9}, 3.6910856091348047`*^9, {
   3.691085657743189*^9, 3.6910856729919233`*^9}, {3.6910860018877287`*^9, 
   3.691086027762576*^9}, {3.691086109554246*^9, 3.6910861198801527`*^9}, {
   3.691086353934422*^9, 3.6910863772130737`*^9}, 3.691086519526157*^9, {
   3.691086662206037*^9, 3.691086662924478*^9}, {3.691086779013865*^9, 
   3.691086794435553*^9}, {3.69108683176619*^9, 3.691086915873322*^9}, {
   3.691103622631735*^9, 3.691103630061858*^9}, {3.691104671329742*^9, 
   3.691104679251082*^9}, {3.6911047535409613`*^9, 3.6911047591635313`*^9}, {
   3.691104944881855*^9, 3.6911050061813383`*^9}, 3.6911050388908653`*^9, {
   3.691105141391584*^9, 3.6911051482164288`*^9}, {3.69115632126731*^9, 
   3.691156324003272*^9}, {3.691176647831791*^9, 3.691176679953165*^9}, {
   3.6911767632074757`*^9, 3.691176776425096*^9}, 3.691176835203197*^9, {
   3.691177096590589*^9, 3.691177103563148*^9}, {3.691177314257209*^9, 
   3.6911773234531517`*^9}, {3.691177377404929*^9, 3.69117738235295*^9}, {
   3.69117754981756*^9, 3.691177554215509*^9}, {3.6911776935802526`*^9, 
   3.691177720141809*^9}, {3.691177760655189*^9, 3.691177761165917*^9}, {
   3.691177823634021*^9, 3.6911778849913073`*^9}, {3.6911780310083303`*^9, 
   3.691178033788807*^9}, {3.691178072007534*^9, 3.691178072357499*^9}, {
   3.691178154582274*^9, 3.691178155487215*^9}, {3.691178350058144*^9, 
   3.691178401305657*^9}, {3.691178469434713*^9, 3.691178476496018*^9}, {
   3.6911785295432987`*^9, 3.691178623436234*^9}, {3.6911788407449007`*^9, 
   3.69117884943681*^9}, {3.691178879912711*^9, 3.69117893675196*^9}, {
   3.691178990424559*^9, 3.691179017841655*^9}, {3.691200294345408*^9, 
   3.691200294548155*^9}, {3.6912687446903667`*^9, 3.691268815038472*^9}, {
   3.6914408336361732`*^9, 3.691440922804969*^9}, {3.691441030927013*^9, 
   3.6914410681777143`*^9}, {3.6914416471300287`*^9, 3.691441650484251*^9}, 
   3.691441693592567*^9, {3.691441751892974*^9, 3.6914418379727583`*^9}, {
   3.691442450976068*^9, 3.691442489675132*^9}, {3.691444654492898*^9, 
   3.6914446781629877`*^9}, {3.691444917407988*^9, 3.691444933814139*^9}, {
   3.691445576669776*^9, 3.69144557748374*^9}, {3.691766317411273*^9, 
   3.691766338267125*^9}, {3.691766476463745*^9, 3.691766476613459*^9}, {
   3.6917665147899313`*^9, 3.691766549926785*^9}, {3.691766722185432*^9, 
   3.691766722674061*^9}, {3.6917673093384237`*^9, 3.6917673195297527`*^9}, 
   3.6917673631320953`*^9, {3.691767538548757*^9, 3.6917675806901703`*^9}, {
   3.6917676400391912`*^9, 3.6917677188122663`*^9}, {3.691767758813476*^9, 
   3.69176776009816*^9}, {3.691767827356202*^9, 3.691767829050351*^9}, {
   3.691768357555561*^9, 3.691768357957837*^9}, {3.6917827880470953`*^9, 
   3.691782800508861*^9}, {3.691783118889618*^9, 3.691783146342165*^9}, {
   3.691783778242764*^9, 3.691783785869566*^9}, {3.6917867805643*^9, 
   3.691786812937738*^9}, {3.691786917388873*^9, 3.691786927652137*^9}, {
   3.6917870442460127`*^9, 3.691787064093296*^9}, {3.6918677561062193`*^9, 
   3.691867756627722*^9}, {3.691867869822748*^9, 3.6918679392256727`*^9}, {
   3.691868106592669*^9, 3.691868114504993*^9}, {3.691868204535799*^9, 
   3.691868244035664*^9}, {3.691868290635932*^9, 3.691868328178712*^9}, {
   3.691868486289102*^9, 3.691868554283989*^9}, {3.69186871940903*^9, 
   3.691868727081386*^9}, {3.691868847484953*^9, 3.6918688553313217`*^9}, {
   3.69187020348382*^9, 3.691870234167632*^9}, 3.69187027962609*^9, {
   3.6918703234083033`*^9, 3.691870339631562*^9}, {3.691870577537575*^9, 
   3.691870583753471*^9}, {3.691870731887967*^9, 3.69187075028505*^9}, {
   3.69187079579764*^9, 3.691870797108287*^9}, {3.6918750595793247`*^9, 
   3.691875059768462*^9}, {3.691875236470525*^9, 3.691875306735306*^9}, {
   3.6918753391595287`*^9, 3.691875345757331*^9}, {3.6918753978468447`*^9, 
   3.6918754496219063`*^9}, {3.691875490069586*^9, 3.691875529135189*^9}, {
   3.6918757091841908`*^9, 3.691875729178653*^9}, {3.6918758000127153`*^9, 
   3.691875800817832*^9}, {3.691875943710884*^9, 3.6918759493230963`*^9}, {
   3.6918759880996323`*^9, 3.691876027580682*^9}, {3.6918760893732443`*^9, 
   3.691876129060287*^9}, {3.69187623697477*^9, 3.691876249724524*^9}, {
   3.69187651998847*^9, 3.6918765366703787`*^9}, {3.69187657592559*^9, 
   3.69187659101926*^9}, {3.691876639652364*^9, 3.691876645449834*^9}, {
   3.691876708963608*^9, 3.691876716419114*^9}, {3.6918772037656116`*^9, 
   3.691877232102674*^9}, {3.691877263138509*^9, 3.691877293826786*^9}, {
   3.6918783190322742`*^9, 3.691878332536697*^9}, {3.691878487820011*^9, 
   3.691878495606099*^9}, {3.691878655393692*^9, 3.691878655829605*^9}, {
   3.6918787546946507`*^9, 3.691878755217108*^9}, {3.691878965420251*^9, 
   3.691879008367275*^9}, {3.691962578632821*^9, 3.6919626344255037`*^9}, {
   3.6919626888176613`*^9, 3.691962691988947*^9}, {3.6919627373402243`*^9, 
   3.691962816567253*^9}, {3.691962854440136*^9, 3.691962953116857*^9}, {
   3.69196299070683*^9, 3.691962991458053*^9}, {3.691963022805437*^9, 
   3.691963027666133*^9}, {3.6919630680119677`*^9, 3.691963068314453*^9}, 
   3.6919631152121677`*^9, {3.6919632356039543`*^9, 3.691963238865512*^9}, {
   3.69196334971286*^9, 3.691963426088532*^9}, {3.691963457118108*^9, 
   3.691963465886672*^9}, {3.691963805823061*^9, 3.691963846936035*^9}, {
   3.691963886399293*^9, 3.69196388830233*^9}, {3.691964129254722*^9, 
   3.691964177161542*^9}, {3.6919642149779177`*^9, 3.6919642271633244`*^9}, {
   3.69196434812808*^9, 3.691964349017774*^9}, {3.691964388027083*^9, 
   3.691964388627206*^9}, 3.6919654771870203`*^9, {3.692036888424389*^9, 
   3.692036889125966*^9}, {3.6920369234944267`*^9, 3.6920369429793777`*^9}, {
   3.69203724778893*^9, 3.692037253038005*^9}, {3.6920380538507357`*^9, 
   3.692038055604875*^9}, {3.692038815826708*^9, 3.6920388229866133`*^9}, {
   3.692038937305092*^9, 3.6920389375215197`*^9}, {3.692039056631694*^9, 
   3.6920390671136293`*^9}, {3.692039236193684*^9, 3.6920392502271347`*^9}, {
   3.692039401427403*^9, 3.6920394055579*^9}, {3.692039441257799*^9, 
   3.692039463130777*^9}, {3.692040039933104*^9, 3.692040074847026*^9}, {
   3.692040255000802*^9, 3.692040293844688*^9}, {3.692040332845829*^9, 
   3.6920403452267523`*^9}, {3.692040564345914*^9, 3.692040620874855*^9}, {
   3.6920436205130367`*^9, 3.692043784264737*^9}, {3.6920442939514427`*^9, 
   3.692044307961134*^9}, {3.692044355427346*^9, 3.6920443621536903`*^9}, {
   3.692044398975852*^9, 3.69204444826052*^9}, {3.6920448166534157`*^9, 
   3.692044846331561*^9}, {3.692044919977059*^9, 3.6920449202067738`*^9}, {
   3.692045070293063*^9, 3.692045071826881*^9}, {3.692045431042514*^9, 
   3.692045643533095*^9}, {3.6920456847971783`*^9, 3.6920457386601057`*^9}, {
   3.692045770647873*^9, 3.692045787615478*^9}, {3.692045845654417*^9, 
   3.6920458615884933`*^9}, {3.692045945059011*^9, 3.692045966291074*^9}, {
   3.692111873612102*^9, 3.692111951928402*^9}, {3.6921119878424377`*^9, 
   3.692112008011162*^9}, {3.69211204715648*^9, 3.692112058096305*^9}, {
   3.692112112866864*^9, 3.6921121497159443`*^9}, {3.6921122710114403`*^9, 
   3.692112275196534*^9}, {3.692112580120083*^9, 3.6921125845366297`*^9}, {
   3.692112638850436*^9, 3.692112641625296*^9}, {3.692112803909258*^9, 
   3.692112867303944*^9}, 3.6921134311890717`*^9, {3.692113983884674*^9, 
   3.6921140173563747`*^9}, {3.692115030081726*^9, 3.6921150305213947`*^9}, {
   3.692115222076387*^9, 3.692115230462679*^9}, {3.692115442281733*^9, 
   3.6921154530067863`*^9}, {3.692115539864996*^9, 3.692115561125555*^9}, {
   3.692115645074645*^9, 3.6921157327566*^9}, {3.692116092465743*^9, 
   3.692116092824362*^9}, {3.692116139769641*^9, 3.6921161399358273`*^9}, {
   3.69211648357472*^9, 3.6921164839659967`*^9}, {3.6921171782889557`*^9, 
   3.692117190503944*^9}, {3.6921178292421217`*^9, 3.692117879273094*^9}, {
   3.692117916084578*^9, 3.69211791645155*^9}, {3.69211864968353*^9, 
   3.692118658710451*^9}, {3.692122806079196*^9, 3.692122810613133*^9}, {
   3.692123267273011*^9, 3.6921232677882977`*^9}, {3.692123795805484*^9, 
   3.692123796673829*^9}, {3.692216533444798*^9, 3.692216601294033*^9}, {
   3.692216637049055*^9, 3.69221667353745*^9}, {3.692216817547269*^9, 
   3.692216824362751*^9}, {3.692217212481381*^9, 3.6922172282159357`*^9}, {
   3.6922172590770082`*^9, 3.692217264195936*^9}, {3.6922173664568577`*^9, 
   3.692217422025939*^9}, {3.6922174592498903`*^9, 3.692217459770974*^9}, {
   3.6922176974023027`*^9, 3.692217725394348*^9}, {3.6922178626606493`*^9, 
   3.692217947347947*^9}, {3.6922179981423683`*^9, 3.692218011449963*^9}, {
   3.692218051293037*^9, 3.692218082101406*^9}, {3.692218120811221*^9, 
   3.692218128747793*^9}, 3.692218226710764*^9, {3.6922183088377523`*^9, 
   3.692218315869529*^9}, 3.692218383163207*^9, {3.692218608933158*^9, 
   3.6922186308803387`*^9}, {3.692218734848193*^9, 3.692218751669368*^9}, {
   3.692218821259818*^9, 3.692218821476368*^9}, 3.692218892494063*^9, {
   3.692218972908996*^9, 3.6922189744286833`*^9}, {3.692219140910659*^9, 
   3.6922192269248466`*^9}, {3.692219273772669*^9, 3.692219321706553*^9}, {
   3.692219352034255*^9, 3.6922193725321417`*^9}, {3.692236657703113*^9, 
   3.6922366582123833`*^9}, {3.69223670031434*^9, 3.692236707516931*^9}, {
   3.692236879128594*^9, 3.692236931094692*^9}, {3.692237192585882*^9, 
   3.692237200436398*^9}, {3.692237375516067*^9, 3.692237393091301*^9}, {
   3.692237426808091*^9, 3.6922374488946447`*^9}, {3.692237896499364*^9, 
   3.6922379900293217`*^9}, {3.6922381059273*^9, 3.692238109089497*^9}, {
   3.692238156136457*^9, 3.692238170320794*^9}, {3.692238233292387*^9, 
   3.692238276072413*^9}, {3.692238460233171*^9, 3.6922384607385178`*^9}, 
   3.692239067637062*^9, {3.692239114441428*^9, 3.692239170532139*^9}, 
   3.692239303631022*^9, {3.692239359434767*^9, 3.6922393739517527`*^9}, 
   3.692239565852285*^9, {3.692294473964446*^9, 3.6922944746199703`*^9}, {
   3.692305837376237*^9, 3.692305900016643*^9}, {3.692305982487945*^9, 
   3.692306021422364*^9}, 3.692306060759953*^9, {3.692306094039215*^9, 
   3.6923061202364597`*^9}, {3.692306207050993*^9, 3.692306227875196*^9}, {
   3.6923063336711693`*^9, 3.692306334058448*^9}, {3.692306406305292*^9, 
   3.6923064095641403`*^9}, {3.692307331900962*^9, 3.692307355861746*^9}, {
   3.6923074233319893`*^9, 3.692307509096981*^9}, {3.69230802399022*^9, 
   3.6923080952037354`*^9}, {3.6923081615100327`*^9, 3.692308225200721*^9}, {
   3.692308677330649*^9, 3.6923087110211287`*^9}, 3.6923087524846363`*^9, {
   3.692308854940897*^9, 3.692308856044424*^9}, {3.692308901859212*^9, 
   3.6923089025206738`*^9}, {3.692308948396152*^9, 3.692308948570622*^9}, {
   3.69230899420045*^9, 3.692309038267826*^9}, {3.692373835311656*^9, 
   3.692373905991238*^9}, {3.69237396124368*^9, 3.6923739620886497`*^9}, {
   3.692374266206668*^9, 3.692374268028968*^9}, {3.6923747672160263`*^9, 
   3.6923748254018393`*^9}, {3.6923748768403883`*^9, 3.692374887262163*^9}, {
   3.692374933791358*^9, 3.692374943071905*^9}, {3.692375004055867*^9, 
   3.692375006465241*^9}, {3.692375041691846*^9, 3.692375072595313*^9}, {
   3.6923751094148407`*^9, 3.692375124262232*^9}, {3.692375161334395*^9, 
   3.69237516264242*^9}, {3.692375289391161*^9, 3.692375295034966*^9}, {
   3.692375699901113*^9, 3.6923757147882977`*^9}, {3.6923764120663147`*^9, 
   3.6923764129205017`*^9}, {3.6923765418592*^9, 3.692376627552576*^9}, {
   3.6923775261877604`*^9, 3.6923775329986267`*^9}, {3.692377677522431*^9, 
   3.692377684089231*^9}, {3.692377787702251*^9, 3.692377788405665*^9}, {
   3.692378322403297*^9, 3.692378323058909*^9}, {3.69237903850776*^9, 
   3.692379039632311*^9}, {3.692379158588423*^9, 3.692379159340966*^9}, {
   3.692379639265308*^9, 3.692379645073275*^9}, {3.6923797299840384`*^9, 
   3.692379730556918*^9}, {3.6923920556335087`*^9, 3.69239207966284*^9}, {
   3.692392179013795*^9, 3.692392197671661*^9}, {3.692392235469143*^9, 
   3.6923922790342693`*^9}, {3.692392313378196*^9, 3.692392381172853*^9}, {
   3.692392476380979*^9, 3.69239255645385*^9}, {3.69239269251912*^9, 
   3.692392697381078*^9}, {3.692393158187292*^9, 3.692393180087544*^9}, {
   3.692393357902369*^9, 3.692393373913082*^9}, {3.692460923349514*^9, 
   3.692460926629171*^9}, 3.6928306410333443`*^9, {3.692830682049965*^9, 
   3.6928307403955975`*^9}, {3.697852824573469*^9, 3.6978528300458736`*^9}, {
   3.6978537361122046`*^9, 3.6978537666192126`*^9}, 3.697853880565686*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"outputgen2", "=", 
     RowBox[{"generatescheduletheaterMma8", "[", 
      RowBox[{
       RowBox[{"Take", "[", 
        RowBox[{"fivetheaterdays", ",", "723"}], "]"}], ",", "MinInterval", 
       ",", "MaxLoiter"}], "]"}]}], ";", "\n", 
    RowBox[{"tax", "=", 
     RowBox[{"tailassign", "[", 
      RowBox[{
       RowBox[{"outputgen2", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "50", ",", "50", ",", "50", ",", "50"}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"totaltails", "[", 
     RowBox[{"tax", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], "//", 
  "Timing"}]], "Input",
 CellChangeTimes->{{3.692376659605768*^9, 3.692376662691245*^9}, 
   3.692376709381042*^9, {3.69237674608584*^9, 3.692376746290359*^9}, {
   3.69237678873659*^9, 3.692376790291086*^9}, {3.692376841382148*^9, 
   3.692376842131054*^9}, {3.692376887088019*^9, 3.6923768877862263`*^9}, {
   3.692376966827711*^9, 3.6923769673628073`*^9}, {3.692377009482902*^9, 
   3.6923770128155727`*^9}, {3.692377045995392*^9, 3.692377065344523*^9}, {
   3.692377095875299*^9, 3.692377096184154*^9}, {3.692377156880025*^9, 
   3.692377157492922*^9}, {3.69237722210151*^9, 3.692377223018692*^9}, {
   3.692377262241171*^9, 3.6923772630461473`*^9}, {3.692377393412016*^9, 
   3.692377393966559*^9}, 3.692377749752659*^9, {3.692377807203277*^9, 
   3.692377821639977*^9}, {3.692377907530237*^9, 3.6923779382877703`*^9}, 
   3.6923780748845243`*^9, {3.692378795535961*^9, 3.692378796769161*^9}, 
   3.692379063423238*^9, {3.692379111439053*^9, 3.692379111745048*^9}, {
   3.6923934074215612`*^9, 3.692393427988214*^9}, 3.692393695216351*^9, {
   3.692393753323782*^9, 3.692393753551268*^9}, {3.6923938643686733`*^9, 
   3.6923938666455107`*^9}, {3.692394003276678*^9, 3.692394019292555*^9}, {
   3.692394236226511*^9, 3.69239427341567*^9}, {3.692407829289774*^9, 
   3.692407856070612*^9}, {3.692458448293351*^9, 3.6924584528263893`*^9}, {
   3.69245981578155*^9, 3.692459883092992*^9}, {3.69246102280543*^9, 
   3.692461141551257*^9}, 3.6926374082402716`*^9, {3.6926375661253605`*^9, 
   3.6926375726609526`*^9}, {3.6926426084490843`*^9, 
   3.6926426095871663`*^9}, {3.692643401686349*^9, 3.692643402065235*^9}, {
   3.6928210271626563`*^9, 3.692821028210003*^9}, {3.6928211622234354`*^9, 
   3.692821162561796*^9}, {3.6928212519380836`*^9, 3.6928212530891542`*^9}, {
   3.6928214241746016`*^9, 3.6928214247907467`*^9}, {3.692831074309615*^9, 
   3.692831075458246*^9}, {3.6928311846383667`*^9, 3.6928311849703417`*^9}, {
   3.697854389501664*^9, 3.6978543966236534`*^9}, {3.6978547478740244`*^9, 
   3.6978547656547017`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.4375`", ",", 
   RowBox[{"{", "116", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6981873778246355`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"tax", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.692640454960161*^9, 3.692640501475725*^9}}],

Cell[BoxData["181"], "Output",
 CellChangeTimes->{3.6981873778706694`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"RFassigns", "=", 
   RowBox[{"outputgen2", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6925497419497223`*^9, 3.692549749944242*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"altinfo", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"RFassigns", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "3", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RFassigns", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2", ",", "j"}], "]"}], "]"}], ",", 
           RowBox[{"fivetheaterdays", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"RFassigns", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2", ",", "j"}], "]"}], "]"}], ",", "5"}], 
             "]"}], "]"}], ",", 
           RowBox[{"fivetheaterdays", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"RFassigns", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2", ",", "j"}], "]"}], "]"}], ",", "3"}], 
             "]"}], "]"}], ",", 
           RowBox[{"fivetheaterdays", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"RFassigns", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2", ",", "j"}], "]"}], "]"}], ",", "4"}], 
             "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"RFassigns", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}]}], "}"}]}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "RFassigns", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.692549171559183*^9, 3.692549276306732*^9}, {
  3.6925493242921753`*^9, 3.69254938639384*^9}, {3.6925494242837477`*^9, 
  3.692549435484579*^9}, {3.6925494743492107`*^9, 3.692549482705984*^9}, {
  3.692549721354401*^9, 3.692549845914908*^9}, {3.692549913626671*^9, 
  3.692549954126937*^9}, {3.692550000567731*^9, 3.6925500116465273`*^9}, {
  3.692550054350995*^9, 3.6925500825636873`*^9}, {3.692550347108222*^9, 
  3.69255035352791*^9}, {3.69255039630937*^9, 3.6925504554901752`*^9}, {
  3.692551172912733*^9, 3.692551176494892*^9}, {3.692642728395755*^9, 
  3.6926427414547377`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"altanchinfo", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{"altinfo", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "i"}], "&"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "i", ",", "23"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.692550975606923*^9, 3.692551095609517*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lowaltindices", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"altanchinfo", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "3", ",", "k", ",", "2"}], "]"}],
                 "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"altanchinfo", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}], "]"}]}], 
                "}"}]}], "]"}], "]"}], "\[LessEqual]", "18000."}], ",", 
           RowBox[{"altanchinfo", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"altanchinfo", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "23"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"highaltindices", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"altanchinfo", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "3", ",", "k", ",", "2"}], "]"}],
                 "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"altanchinfo", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}], "]"}]}], 
                "}"}]}], "]"}], "]"}], ">", "18000."}], ",", 
           RowBox[{"altanchinfo", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], ",", "0"}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"Length", "[", 
            RowBox[{"altanchinfo", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
       "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "23"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.692552748184807*^9, 3.692552760425947*^9}, {
  3.692552803194314*^9, 3.692552840610116*^9}, {3.692552902878306*^9, 
  3.692552931060821*^9}, {3.692553025533186*^9, 3.692553033575263*^9}, {
  3.692553103095784*^9, 3.692553122303969*^9}, {3.692553222166913*^9, 
  3.6925532225522203`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"altitudeindices", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lowaltindices", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"highaltindices", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "23"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.692553160958062*^9, 3.6925531887568083`*^9}, 
   3.69256993989692*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eventsfromlowindices", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"eventsfromindices", "[", 
      RowBox[{
       RowBox[{"lowaltindices", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "fivetheaterdays", ",", 
       "RFassigns"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"lowaltindices", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.692557789839794*^9, 3.692557886581225*^9}, 
   3.6925579192554693`*^9, {3.692642788589706*^9, 3.6926427912095003`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eventsfromhighindices", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"eventsfromindices", "[", 
      RowBox[{
       RowBox[{"highaltindices", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "fivetheaterdays", ",", 
       "RFassigns"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"highaltindices", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ7eP360FW9WtH04KSVyB65wTL7yD6xvS5HNlAelIN
tziI3jHFRQpE/6jO1wbRU/VvgGm115dn/Wl67Si2h3k2iL7HXr0YROefzF8N
oq+dvLkJRL/IiN4Kotc9mnUcRC+aI3MaRNd8rb0Aom+eNbgOovsE5t0G0Vzr
FoDpHIm0RyB6l/GCtyD6+psVz/8C6bDLT16A6JL4pA8g+oj4OTC964yIyD+Q
/oJ/oiC6bEWGPIiekXUITFeplzqB6JiH38H0vfKIUBCtJsuSDKL1ja+dBNEd
zyrPgGiTS0/sNJpfO6ZvjnIA0QC6vrIO
  "]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"highsets", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"altchooser", "[", 
      RowBox[{
       RowBox[{"eventsfromhighindices", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"altitudeindices", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "20", ",", "8"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "23"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"highsets", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.688608246858361*^9, 3.688608318730567*^9}, {
   3.688654976008956*^9, 3.6886549868069105`*^9}, {3.688655027994804*^9, 
   3.688655037741529*^9}, {3.6886550926257763`*^9, 3.688655136535943*^9}, {
   3.6886554497306767`*^9, 3.6886554529571133`*^9}, {3.6886564970427227`*^9, 
   3.6886565021799564`*^9}, {3.6886565714138575`*^9, 
   3.6886566927655716`*^9}, {3.688656749467017*^9, 3.6886567676589513`*^9}, {
   3.692558302372225*^9, 3.6925583026911583`*^9}, 3.6925585905053596`*^9, {
   3.692558698073703*^9, 3.692558698289661*^9}, {3.692558793162471*^9, 
   3.692558823022629*^9}, {3.692564081569223*^9, 3.692564103429839*^9}, {
   3.692564211381338*^9, 3.692564215114023*^9}, {3.692564793689744*^9, 
   3.692564794027732*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lowsets", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"altchooser", "[", 
      RowBox[{
       RowBox[{"eventsfromlowindices", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"altitudeindices", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "20", ",", "7"}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "23"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ls", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"lowsets", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
       RowBox[{"{", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6886083212545576`*^9, 3.688608341650739*^9}, {
  3.688654883636222*^9, 3.6886548936320825`*^9}, {3.6886550308961563`*^9, 
  3.6886550444325256`*^9}, {3.688655095730321*^9, 3.688655139639538*^9}, {
  3.6886554565398664`*^9, 3.688655460797448*^9}, {3.68865551549623*^9, 
  3.6886555158652086`*^9}, {3.6886565055978336`*^9, 3.688656510486884*^9}, {
  3.6886567941582603`*^9, 3.688656802586187*^9}, {3.6886568492180166`*^9, 
  3.6886568545072126`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tankeralts", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "RFassigns", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"tankeralts", "=", 
     RowBox[{"sortiealtset", "[", 
      RowBox[{"anchno", ",", "ls", ",", "hs", ",", "tankeralts"}], "]"}]}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"anchno", ",", "23"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.692564738434244*^9, 3.692564767815701*^9}, {
  3.6925648761864767`*^9, 3.6925648844589653`*^9}, {3.692564951176772*^9, 
  3.692565011799231*^9}, {3.692565047988852*^9, 3.692565048259645*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"sortiesmma", "=", 
   RowBox[{"assembletheatersorties", "[", 
    RowBox[{"RFassigns", ",", "fivetheaterdays", ",", "tankeralts"}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.692567831389804*^9, 3.692567843980036*^9}, {
  3.692568271168538*^9, 3.6925683271498623`*^9}, {3.692568488029147*^9, 
  3.692568520882135*^9}, {3.692568770550252*^9, 3.692568804356832*^9}, {
  3.692569449344494*^9, 3.692569479485691*^9}, {3.692642828424221*^9, 
  3.6926428301793394`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"numsorties = \"\>", "\[InvisibleSpace]", "181"}],
  SequenceForm["numsorties = ", 181],
  Editable->False]], "Print",
 CellChangeTimes->{3.698187378030283*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"altitudemissions", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"sortiefuelburn", "[", 
      RowBox[{"RFassigns", ",", "sortiesmma", ",", "i"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "RFassigns", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.692639848952094*^9, 3.6926398855703793`*^9}, {
  3.692639973682539*^9, 3.6926399754526625`*^9}, {3.692643056751648*^9, 
  3.692643062226037*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mt", "=", 
   RowBox[{"missiontails", "[", 
    RowBox[{"tax", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.692640747756939*^9, 3.6926407558948765`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"altitudemissionCSV", "=", 
   RowBox[{"formatnoncombines", "[", 
    RowBox[{"altitudemissions", ",", "mt"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.692640939279845*^9, 3.6926409809434566`*^9}, {
   3.6926410502513494`*^9, 3.6926410577448072`*^9}, {3.6926428716167397`*^9, 
   3.6926428775038633`*^9}, 3.692643491064685*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "altitudemissionCSV", "]"}]], "Input",
 CellChangeTimes->{{3.6926430385473113`*^9, 3.6926430451540203`*^9}, 
   3.692643499729329*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"181", ",", "5"}], "}"}]], "Output",
 CellChangeTimes->{3.698187394596628*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"missionaltoutCSV", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"altitudemissionCSV", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "1"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "altitudemissionCSV", "]"}]}], "}"}]}], "]"}],
      ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6926413404442377`*^9, 3.6926413857632165`*^9}, {
  3.6926428956534114`*^9, 3.6926429164399276`*^9}, {3.6926435120312996`*^9, 
  3.6926435213703737`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<AltitudeShifts.csv\>\"", ",", " ", "missionaltoutCSV"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6926414023261347`*^9, 3.692641410270045*^9}, {
   3.6926414407806845`*^9, 3.69264147784859*^9}, {3.692641778670642*^9, 
   3.6926417820279083`*^9}, {3.6926425254953127`*^9, 3.692642527930554*^9}, {
   3.6926429040947*^9, 3.6926429311091385`*^9}, 3.692643154898474*^9, {
   3.6926435390294*^9, 3.6926435538992767`*^9}, {3.692803827255598*^9, 
   3.6928038325398026`*^9}, {3.6928040118433695`*^9, 
   3.6928040151936364`*^9}, {3.692821107025262*^9, 3.692821115463423*^9}, {
   3.692821185230868*^9, 3.692821203462206*^9}, {3.692821284066862*^9, 
   3.6928212877855945`*^9}, {3.692821353333161*^9, 3.6928213638215675`*^9}, {
   3.6928214117095118`*^9, 3.6928214373981223`*^9}, {3.6928308109696274`*^9, 
   3.6928308149207735`*^9}, {3.692830917114005*^9, 3.6928309192947206`*^9}, {
   3.6928310868827367`*^9, 3.6928310883528337`*^9}, 3.6928311708892965`*^9, {
   3.6978535114415026`*^9, 3.6978535268831863`*^9}, {3.6981880073077497`*^9, 
   3.6981880134668937`*^9}, {3.698188087570283*^9, 3.6981880896666*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "missionaltoutCSV", "]"}]], "Input",
 CellChangeTimes->{{3.692641388465623*^9, 3.6926413928839917`*^9}, {
   3.6926429520139666`*^9, 3.6926429529304466`*^9}, 3.6926431687464333`*^9, 
   3.692643566492317*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1447", ",", "30"}], "}"}]], "Output",
 CellChangeTimes->{3.6981873946306334`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->"RulerBar",
WindowSize->{1707, 877},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
Magnification:>1.4 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 805, 16, 170, "Input"],
Cell[1353, 38, 379, 7, 57, "Input"],
Cell[1735, 47, 258, 6, 72, "Input"],
Cell[1996, 55, 650, 15, 72, "Input"],
Cell[2649, 72, 303, 7, 43, "Input"],
Cell[2955, 81, 4098, 105, 324, "Input"],
Cell[7056, 188, 1571, 39, 240, "Input"],
Cell[8630, 229, 2754, 68, 352, "Input"],
Cell[11387, 299, 2325, 55, 324, "Input"],
Cell[13715, 356, 2945, 73, 352, "Input"],
Cell[16663, 431, 1863, 46, 352, "Input"],
Cell[18529, 479, 918, 23, 128, "Input"],
Cell[19450, 504, 998, 26, 240, "Input"],
Cell[20451, 532, 583, 18, 72, "Input"],
Cell[21037, 552, 3181, 79, 436, "Input"],
Cell[24221, 633, 3823, 93, 408, "Input"],
Cell[28047, 728, 4352, 104, 408, "Input"],
Cell[32402, 834, 236, 4, 42, "Text"],
Cell[32641, 840, 520, 13, 43, "Input"],
Cell[33164, 855, 190, 2, 42, "Text"],
Cell[33357, 859, 635, 16, 43, "Input"],
Cell[33995, 877, 1230, 33, 100, "Input"],
Cell[35228, 912, 1060, 27, 184, "Input"],
Cell[36291, 941, 1421, 32, 240, "Input"],
Cell[37715, 975, 1172, 28, 240, "Input"],
Cell[38890, 1005, 12183, 255, 1360, "Input"],
Cell[51076, 1262, 5483, 121, 632, "Input"],
Cell[56562, 1385, 1497, 35, 296, "Input"],
Cell[58062, 1422, 1429, 37, 240, "Input"],
Cell[59494, 1461, 167, 3, 43, "Input"],
Cell[59664, 1466, 2656, 63, 352, "Input"],
Cell[62323, 1531, 4501, 98, 520, "Input"],
Cell[66827, 1631, 883, 21, 43, "Input"],
Cell[67713, 1654, 684, 18, 43, "Input"],
Cell[68400, 1674, 16962, 343, 1108, "Input"],
Cell[85365, 2019, 11378, 259, 1276, "Input"],
Cell[96746, 2280, 4563, 103, 212, "Input"],
Cell[101312, 2385, 2713, 64, 156, "Input"],
Cell[104028, 2451, 3080, 71, 184, "Input"],
Cell[107111, 2524, 3780, 92, 296, "Input"],
Cell[110894, 2618, 3964, 96, 296, "Input"],
Cell[114861, 2716, 3845, 93, 240, "Input"],
Cell[118709, 2811, 1731, 43, 212, "Input"],
Cell[120443, 2856, 1860, 48, 212, "Input"],
Cell[122306, 2906, 2575, 64, 156, "Input"],
Cell[124884, 2972, 3926, 93, 324, "Input"],
Cell[128813, 3067, 2092, 47, 380, "Input"],
Cell[130908, 3116, 2698, 57, 436, "Input"],
Cell[CellGroupData[{
Cell[133631, 3177, 160, 2, 39, "Subsubtitle"],
Cell[CellGroupData[{
Cell[133816, 3183, 320, 8, 43, "Input"],
Cell[134139, 3193, 178, 3, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134354, 3201, 159, 3, 43, "Input"],
Cell[134516, 3206, 556, 10, 31, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135109, 3221, 1739, 28, 72, "Input"],
Cell[136851, 3251, 636, 14, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137524, 3270, 975, 19, 72, "Input"],
Cell[138502, 3291, 510, 12, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139049, 3308, 1159, 21, 72, "Input"],
Cell[140211, 3331, 516, 12, 72, "Output"]
}, Open  ]],
Cell[140742, 3346, 606, 16, 100, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141385, 3367, 113, 1, 39, "Subsubtitle"],
Cell[141501, 3370, 5470, 136, 604, "Input"],
Cell[146974, 3508, 1672, 45, 72, "Input"],
Cell[148649, 3555, 1295, 34, 240, "Input"],
Cell[149947, 3591, 5822, 119, 352, "Input"],
Cell[155772, 3712, 1245, 33, 212, "Input"],
Cell[157020, 3747, 94, 1, 43, "Input"],
Cell[CellGroupData[{
Cell[157139, 3752, 123, 2, 43, "Input"],
Cell[157265, 3756, 4906, 79, 520, "Output"]
}, Open  ]],
Cell[162186, 3838, 926, 20, 100, "Input"],
Cell[163115, 3860, 580, 13, 72, "Input"],
Cell[CellGroupData[{
Cell[163720, 3877, 188, 3, 43, "Input"],
Cell[163911, 3882, 139, 3, 43, "Output"]
}, Open  ]],
Cell[164065, 3888, 2773, 78, 156, "Input"],
Cell[166841, 3968, 265, 5, 42, "Text"],
Cell[167109, 3975, 88, 1, 42, "Text"],
Cell[167200, 3978, 3565, 78, 520, "Input"],
Cell[170768, 4058, 769, 12, 43, "Input"],
Cell[171540, 4072, 401, 12, 43, "Input"],
Cell[171944, 4086, 151, 3, 42, "Text"],
Cell[172098, 4091, 565, 17, 43, "Input"],
Cell[172666, 4110, 964, 23, 43, "Input"],
Cell[173633, 4135, 2993, 73, 352, "Input"],
Cell[176629, 4210, 454, 13, 43, "Input"],
Cell[177086, 4225, 517, 16, 43, "Input"],
Cell[177606, 4243, 262, 5, 42, "Text"],
Cell[177871, 4250, 2376, 62, 156, "Input"],
Cell[180250, 4314, 372, 6, 42, "Text"],
Cell[180625, 4322, 1045, 26, 43, "Input"],
Cell[181673, 4350, 593, 9, 97, "Text"],
Cell[182269, 4361, 2561, 64, 184, "Input"],
Cell[184833, 4427, 193, 4, 42, "Text"],
Cell[185029, 4433, 1418, 38, 128, "Input"],
Cell[186450, 4473, 571, 12, 72, "Input"],
Cell[187024, 4487, 977, 19, 72, "Input"],
Cell[188004, 4508, 2490, 71, 156, "Input"],
Cell[190497, 4581, 48089, 958, 3348, "Input"],
Cell[CellGroupData[{
Cell[238611, 5543, 2750, 49, 100, "Input"],
Cell[241364, 5594, 149, 4, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241550, 5603, 241, 6, 43, "Input"],
Cell[241794, 5611, 74, 1, 43, "Output"]
}, Open  ]],
Cell[241883, 5615, 206, 5, 43, "Input"],
Cell[242092, 5622, 2298, 57, 128, "Input"],
Cell[244393, 5681, 465, 14, 43, "Input"],
Cell[244861, 5697, 2990, 79, 184, "Input"],
Cell[247854, 5778, 488, 14, 43, "Input"],
Cell[248345, 5794, 738, 20, 43, "Input"],
Cell[249086, 5816, 980, 26, 43, "Input"],
Cell[250069, 5844, 1655, 40, 72, "Input"],
Cell[251727, 5886, 1375, 36, 72, "Input"],
Cell[253105, 5924, 706, 18, 43, "Input"],
Cell[CellGroupData[{
Cell[253836, 5946, 507, 10, 43, "Input"],
Cell[254346, 5958, 208, 5, 31, "Print"]
}, Open  ]],
Cell[254569, 5966, 508, 13, 43, "Input"],
Cell[255080, 5981, 234, 6, 43, "Input"],
Cell[255317, 5989, 368, 7, 43, "Input"],
Cell[CellGroupData[{
Cell[255710, 6000, 176, 3, 43, "Input"],
Cell[255889, 6005, 117, 3, 43, "Output"]
}, Open  ]],
Cell[256021, 6011, 651, 17, 43, "Input"],
Cell[256675, 6030, 1179, 18, 43, "Input"],
Cell[CellGroupData[{
Cell[257879, 6052, 250, 4, 43, "Input"],
Cell[258132, 6058, 121, 3, 43, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

